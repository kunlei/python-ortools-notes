<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.306">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Hands-on Optimization with OR-Tools in Python - 3&nbsp; Linear Programming</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./integer-programming.html" rel="next">
<link href="./env-setup.html" rel="prev">
<link href="./logo.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-DTVHQH448R"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-DTVHQH448R', { 'anonymize_ip': true});
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        TeX: { equationNumbers: {autoNumber: "AMS"} },
        tex2jax: {inlineMath: [ ['$','$'], ["\\(","\\)"] ]}
    });
    </script>

<!-- This is what works with Quarto -->
<script>
    MathJax = {
        tex: {
            tags: 'ams'  // should be 'ams', 'none', or 'all'
        }
    };
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="twitter:title" content="Hands-on Optimization with OR-Tools in Python - 3&nbsp; Linear Programming">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://kunlei.github.io/python-ortools-notes/linear-programming_files/figure-html/fig-lp-example-output-1.png">
<meta name="twitter:image-height" content="389">
<meta name="twitter:image-width" content="515">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./linear-programming.html">Mathematical Programming</a></li><li class="breadcrumb-item"><a href="./linear-programming.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Linear Programming</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Hands-on Optimization with OR-Tools in Python</a> 
        <div class="sidebar-tools-main">
    <a href="https://twitter.com/intent/tweet?url=|url|" title="Twitter" class="quarto-navigation-tool px-1" aria-label="Twitter"><i class="bi bi-twitter"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">For the Impatient</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./env-setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Environment Setup</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Mathematical Programming</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear-programming.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Linear Programming</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./integer-programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Integer Programming</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ip-jsp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Job Shop Scheduling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ip-tsp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Traveling Salesman Problem</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ip-cvrp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Capacitated Vehicle Routing Problem</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ip-rcps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Resource Constrained Project Scheduling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ip-nqueens.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">The N-queens Problem</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ip-knapsack.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">The Knapsack Problem</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./column-generation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Column Generation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Constraint Programming</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Tailored Algorithms</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#modeling-capabilities" id="toc-modeling-capabilities" class="nav-link active" data-scroll-target="#modeling-capabilities"><span class="header-section-number">3.1</span> Modeling Capabilities</a>
  <ul class="collapse">
  <li><a href="#solver" id="toc-solver" class="nav-link" data-scroll-target="#solver"><span class="header-section-number">3.1.1</span> Solver</a></li>
  <li><a href="#decision-variables" id="toc-decision-variables" class="nav-link" data-scroll-target="#decision-variables"><span class="header-section-number">3.1.2</span> Decision Variables</a></li>
  <li><a href="#constraints" id="toc-constraints" class="nav-link" data-scroll-target="#constraints"><span class="header-section-number">3.1.3</span> Constraints</a></li>
  <li><a href="#objective" id="toc-objective" class="nav-link" data-scroll-target="#objective"><span class="header-section-number">3.1.4</span> Objective</a></li>
  <li><a href="#objective-and-constraint-expressions" id="toc-objective-and-constraint-expressions" class="nav-link" data-scroll-target="#objective-and-constraint-expressions"><span class="header-section-number">3.1.5</span> Objective and Constraint Expressions</a></li>
  <li><a href="#query-the-model" id="toc-query-the-model" class="nav-link" data-scroll-target="#query-the-model"><span class="header-section-number">3.1.6</span> Query the Model</a></li>
  </ul></li>
  <li><a href="#applications" id="toc-applications" class="nav-link" data-scroll-target="#applications"><span class="header-section-number">3.2</span> Applications</a>
  <ul class="collapse">
  <li><a href="#trivial-problem" id="toc-trivial-problem" class="nav-link" data-scroll-target="#trivial-problem"><span class="header-section-number">3.2.1</span> Trivial Problem</a></li>
  <li><a href="#transportation-problem" id="toc-transportation-problem" class="nav-link" data-scroll-target="#transportation-problem"><span class="header-section-number">3.2.2</span> Transportation Problem</a></li>
  <li><a href="#resource-allocation-problem" id="toc-resource-allocation-problem" class="nav-link" data-scroll-target="#resource-allocation-problem"><span class="header-section-number">3.2.3</span> Resource Allocation Problem</a></li>
  <li><a href="#workforce-planning-problem" id="toc-workforce-planning-problem" class="nav-link" data-scroll-target="#workforce-planning-problem"><span class="header-section-number">3.2.4</span> Workforce Planning Problem</a></li>
  <li><a href="#sudoku-problem" id="toc-sudoku-problem" class="nav-link" data-scroll-target="#sudoku-problem"><span class="header-section-number">3.2.5</span> Sudoku Problem</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-linear" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Linear Programming</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>In this chapter, we first go through the modeling capabilities provided by Google OR-Tools to solve linear programming problems. Then we get our hands dirty by solving some linear programming problems.</p>
<section id="modeling-capabilities" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="modeling-capabilities"><span class="header-section-number">3.1</span> Modeling Capabilities</h2>
<p>There are three components in a mathematical model, namely, decision varaibles, constraints and objective, for which we will go over in the following sections.</p>
<section id="solver" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="solver"><span class="header-section-number">3.1.1</span> Solver</h3>
<p>In Google OR-Tools, a <code>Solver</code> instance must be created first so that variables, constraints and objective can be added to it. The <code>Solver</code> class is defined in the <code>ortools.linear_solver.pywraplp</code> module and it requires a solver id to instantiate an object. In the code snippet below, the required module is imported first and a <code>solver</code> object is created with <code>GLOP</code>, Google’s own optimization engine for solving linear programming problems. It is good practice to verify whether the desired solver is indeed created successfully or not.</p>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">from</span> ortools.linear_solver <span class="im">import</span> pywraplp</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a>solver <span class="op">=</span> pywraplp.Solver.CreateSolver(<span class="st">"GLOP"</span>)</span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="cf">if</span> solver:</span>
<span id="cb1-6"><a href="#cb1-6"></a>    <span class="bu">print</span>(<span class="st">"solver creation success!"</span>)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="cf">else</span>:</span>
<span id="cb1-8"><a href="#cb1-8"></a>    <span class="bu">print</span>(<span class="st">"solver creation failure!"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>solver creation success!</code></pre>
</div>
</div>
</section>
<section id="decision-variables" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="decision-variables"><span class="header-section-number">3.1.2</span> Decision Variables</h3>
<p>The <code>Solver</code> class defines a number of ways to create decision variables:</p>
<ol type="1">
<li><code>Var(lb, ub, integer, name)</code></li>
<li><code>NumVar(lb, ub, name)</code></li>
<li><code>IntVar(lb, ub, name)</code></li>
<li><code>BoolVar(name)</code></li>
</ol>
<ul>
<li>Function <code>Var()</code></li>
</ul>
<p>The <code>Var()</code> method is the most flexible way to define variables, as it can be used to create numerical, integral and boolean variables. In the following code, a numerical variable named ‘var1’ is created with bound (0.0, 1.0). Note that the parameter <code>integer</code> is set to <code>False</code> in the call to function <code>Var()</code>.</p>
<div class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a>var1 <span class="op">=</span> solver.Var(lb<span class="op">=</span><span class="dv">0</span>, ub<span class="op">=</span><span class="fl">1.0</span>, integer<span class="op">=</span><span class="va">False</span>, name<span class="op">=</span><span class="st">"var1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We could create an integer variable using the same function:</p>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a>var2 <span class="op">=</span> solver.Var(lb<span class="op">=</span><span class="dv">0</span>, ub<span class="op">=</span><span class="fl">1.0</span>, integer<span class="op">=</span><span class="va">True</span>, name<span class="op">=</span><span class="st">"var2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Function <code>NumVar()</code></li>
</ul>
<p><code>var1</code> could be creatd alternatively using the specialized function <code>NumVar()</code>:</p>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a>var1 <span class="op">=</span> solver.NumVar(lb<span class="op">=</span><span class="dv">0</span>, ub<span class="op">=</span><span class="fl">1.0</span>, name<span class="op">=</span><span class="st">"var1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Function <code>IntVar()</code></li>
</ul>
<p>Similarly, <code>var2</code> could be created alternatively using the specialized function <code>IntVar()</code>:</p>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a>var2 <span class="op">=</span> solver.IntVar(lb<span class="op">=</span><span class="dv">0</span>, ub<span class="op">=</span><span class="fl">1.0</span>, name<span class="op">=</span><span class="st">"var2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Function <code>BoolVar()</code></li>
</ul>
<p>A boolean variable could be created using the <code>BoolVar()</code> function:</p>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a>var3 <span class="op">=</span> solver.BoolVar(name<span class="op">=</span><span class="st">"var3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="constraints" class="level3" data-number="3.1.3">
<h3 data-number="3.1.3" class="anchored" data-anchor-id="constraints"><span class="header-section-number">3.1.3</span> Constraints</h3>
<p>Constraints limit the solution space of an optimization problem, and there are two ways to define constraints in Google OR-Tools. In the first approach, we could use the <code>Add()</code> function to create a constraint and automatically add it to the model at the same time, as the below code snippet illustrates.</p>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a>cons1 <span class="op">=</span> solver.Add(constraint<span class="op">=</span>var1 <span class="op">+</span> var2 <span class="op">&lt;=</span> <span class="dv">1</span>, name<span class="op">=</span><span class="st">"cons1"</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="bu">type</span>(cons1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<pre><code>ortools.linear_solver.pywraplp.Constraint</code></pre>
</div>
</div>
<p>Note that the <code>Add()</code> function returns an object of the <code>Constraint</code> class defined in the <code>pywraplp</code> module, as shown in the code output. It is a good practice to retain the reference of the newly created constraint, as we might want to query its information later on.</p>
<p>The second approach works in a slightly different way. It starts with an empty constraint, with potential lower bound and upper bounds provided, and add components of the constraint gradually. The code snippet below shows an example of adding a second constraint to the model. In this approach, we must retain the reference to the constraint, as it is needed to add decision variables to the constraint in following steps.</p>
<div class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a>cons2 <span class="op">=</span> solver.Constraint(<span class="op">-</span>solver.infinity(), <span class="fl">10.0</span>, <span class="st">"cons2"</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a>cons2.SetCoefficient(var1, <span class="dv">2</span>)</span>
<span id="cb10-3"><a href="#cb10-3"></a>cons2.SetCoefficient(var2, <span class="dv">3</span>)</span>
<span id="cb10-4"><a href="#cb10-4"></a>cons2.SetCoefficient(var3, <span class="dv">4</span>)</span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="bu">type</span>(cons2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<pre><code>ortools.linear_solver.pywraplp.Constraint</code></pre>
</div>
</div>
</section>
<section id="objective" class="level3" data-number="3.1.4">
<h3 data-number="3.1.4" class="anchored" data-anchor-id="objective"><span class="header-section-number">3.1.4</span> Objective</h3>
<p>Similar to constraints, there are two ways to define the objective in Google OR-Tools. In the first approach, we directly add an objective to the model by using the <code>Maximize()</code> or <code>Minimize()</code> function. Below is an example:</p>
<div class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a>solver.Minimize(var1 <span class="op">+</span> var2 <span class="op">+</span> var3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that the function itself does not return a reference to the newly created objective function, but we could use a dedicated function to retrive it:</p>
<div class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a>obj <span class="op">=</span> solver.Objective()</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="bu">print</span>(obj)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;ortools.linear_solver.pywraplp.Objective; proxy of &lt;Swig Object of type 'operations_research::MPObjective *' at 0x10f1e92c0&gt; &gt;</code></pre>
</div>
</div>
<p>In the second approach, we build the objective incrementally, just as in the second approach of creating constraints. Specifically, we start with an empty objective function, and gradually add components to it. In the end, we specify the optimization sense - whether we want to maximize or minimnize the objective.</p>
<div class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a>obj <span class="op">=</span> solver.Objective()</span>
<span id="cb15-2"><a href="#cb15-2"></a>obj.SetCoefficient(var1, <span class="fl">1.0</span>)</span>
<span id="cb15-3"><a href="#cb15-3"></a>obj.SetCoefficient(var2, <span class="fl">1.0</span>)</span>
<span id="cb15-4"><a href="#cb15-4"></a>obj.SetCoefficient(var3, <span class="fl">1.0</span>)</span>
<span id="cb15-5"><a href="#cb15-5"></a>obj.SetMinimization()</span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="bu">print</span>(obj)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;ortools.linear_solver.pywraplp.Objective; proxy of &lt;Swig Object of type 'operations_research::MPObjective *' at 0x10fc86670&gt; &gt;</code></pre>
</div>
</div>
</section>
<section id="objective-and-constraint-expressions" class="level3" data-number="3.1.5">
<h3 data-number="3.1.5" class="anchored" data-anchor-id="objective-and-constraint-expressions"><span class="header-section-number">3.1.5</span> Objective and Constraint Expressions</h3>
<p>When we build constraints or objective functions, sometimes they comprise of complex expressions that we would like to build incrementally, possibly within loops. For example, we might have a mathematical expression of the form <span class="math inline">\(expr = 2x_1 + 3x_2 + 4x_3 + x_4\)</span>, which could be part of the objective function or any constraints. In this case, we can either use the aforementioned <code>SetCoefficient()</code> function to add each element of the expression to the constraint or objective, or we could build an expression first and add it once in the end. The code snippet below shows an example.</p>
<div class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a>infinity <span class="op">=</span> solver.Infinity()</span>
<span id="cb17-2"><a href="#cb17-2"></a>x1 <span class="op">=</span> solver.NumVar(<span class="dv">0</span>, infinity, name<span class="op">=</span><span class="st">"x1"</span>)</span>
<span id="cb17-3"><a href="#cb17-3"></a>x2 <span class="op">=</span> solver.NumVar(<span class="dv">0</span>, infinity, name<span class="op">=</span><span class="st">"x2"</span>)</span>
<span id="cb17-4"><a href="#cb17-4"></a>x3 <span class="op">=</span> solver.NumVar(<span class="dv">0</span>, infinity, name<span class="op">=</span><span class="st">"x3"</span>)</span>
<span id="cb17-5"><a href="#cb17-5"></a>x4 <span class="op">=</span> solver.NumVar(<span class="dv">0</span>, infinity, name<span class="op">=</span><span class="st">"x4"</span>)</span>
<span id="cb17-6"><a href="#cb17-6"></a></span>
<span id="cb17-7"><a href="#cb17-7"></a>expr <span class="op">=</span> []</span>
<span id="cb17-8"><a href="#cb17-8"></a>expr.append(<span class="dv">2</span> <span class="op">*</span> x1)</span>
<span id="cb17-9"><a href="#cb17-9"></a>expr.append(<span class="dv">3</span> <span class="op">*</span> x2)</span>
<span id="cb17-10"><a href="#cb17-10"></a>expr.append(<span class="dv">4</span> <span class="op">*</span> x3)</span>
<span id="cb17-11"><a href="#cb17-11"></a>expr.append(x4)</span>
<span id="cb17-12"><a href="#cb17-12"></a></span>
<span id="cb17-13"><a href="#cb17-13"></a>constr <span class="op">=</span> solver.Add(solver.Sum(expr) <span class="op">&lt;=</span> <span class="dv">10</span>)</span>
<span id="cb17-14"><a href="#cb17-14"></a><span class="bu">print</span>(constr)</span>
<span id="cb17-15"><a href="#cb17-15"></a></span>
<span id="cb17-16"><a href="#cb17-16"></a>solver.Minimize(solver.Sum(expr))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;ortools.linear_solver.pywraplp.Constraint; proxy of &lt;Swig Object of type 'operations_research::MPConstraint *' at 0x10fcb3060&gt; &gt;</code></pre>
</div>
</div>
<p>Of course, it is not obvious here that the retitive calls to the <code>append()</code> method are any more convenient than the <code>SetCoefficient()</code> method. Let’s say that we have a slightly more complex expression of the form <span class="math inline">\(\sum_{0 \le i &lt; 4}w_i \cdot x_i\)</span>, now we could build the expression using a loop:</p>
<div class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a>w <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">1</span>]</span>
<span id="cb19-2"><a href="#cb19-2"></a>x <span class="op">=</span> [x1, x2, x3, x4]</span>
<span id="cb19-3"><a href="#cb19-3"></a>expr <span class="op">=</span> []</span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">4</span>):</span>
<span id="cb19-5"><a href="#cb19-5"></a>    expr.append(w[i] <span class="op">*</span> x[i])</span>
<span id="cb19-6"><a href="#cb19-6"></a></span>
<span id="cb19-7"><a href="#cb19-7"></a>constr <span class="op">=</span> solver.Add(solver.Sum(expr) <span class="op">&lt;=</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="query-the-model" class="level3" data-number="3.1.6">
<h3 data-number="3.1.6" class="anchored" data-anchor-id="query-the-model"><span class="header-section-number">3.1.6</span> Query the Model</h3>
<p>After we build the model, we can query it using some helper functions. For example, to get the total number of constraints, we use the <code>NumVariables()</code> function. In a similar fashion, we can retrieve the total number of constraints with the <code>NumConstraints()</code> function.</p>
<div class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a>num_vars <span class="op">=</span> solver.NumVariables()</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="bu">print</span>(<span class="ss">f"there are a total of </span><span class="sc">{</span>num_vars<span class="sc">}</span><span class="ss"> variables in the model"</span>)</span>
<span id="cb20-3"><a href="#cb20-3"></a></span>
<span id="cb20-4"><a href="#cb20-4"></a>num_constr <span class="op">=</span> solver.NumConstraints()</span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="bu">print</span>(<span class="ss">f"there are a total of </span><span class="sc">{</span>num_constr<span class="sc">}</span><span class="ss"> constraints in the model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>there are a total of 9 variables in the model
there are a total of 4 constraints in the model</code></pre>
</div>
</div>
</section>
</section>
<section id="applications" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="applications"><span class="header-section-number">3.2</span> Applications</h2>
<p>In this section, we use some examples to showcase the modeling capability of Google OR-Tools.</p>
<section id="trivial-problem" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="trivial-problem"><span class="header-section-number">3.2.1</span> Trivial Problem</h3>
<p>We now consider an simple linear programming problem with two decision variables <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>. The formal mathematical model is defined as below:</p>
<p><span class="math display">\[\begin{align}
\text{max.} \quad &amp; x + 2y \\
\text{s.t.} \quad &amp; x + y \le 10 \\
&amp; x &gt;= 1 \\
&amp; y &gt;= 1
\end{align}\]</span></p>
<p><a href="#fig-lp-example">Figure&nbsp;<span>3.1</span></a> shows the three defining constraints represented in blue lines and the feasible space depicted by the orange shaded area. The objective function is indicated by the red dashed lines. It can be seen from the figure that the point in green circle gives the maximal objective value of 19.</p>
<div class="cell" data-execution_count="77">
<div class="cell-output cell-output-display">
<div id="fig-lp-example" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="linear-programming_files/figure-html/fig-lp-example-output-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3.1: A simple LP example</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Let’s now use Google OR-Tools to model and solve this problem. The code snippet below shows the complete program.</p>
<div class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># import Google OR-Tools library</span></span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="im">from</span> ortools.linear_solver <span class="im">import</span> pywraplp</span>
<span id="cb22-3"><a href="#cb22-3"></a></span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="co"># create a solver</span></span>
<span id="cb22-5"><a href="#cb22-5"></a>solver <span class="op">=</span> pywraplp.Solver.CreateSolver(<span class="st">"GLOP"</span>)</span>
<span id="cb22-6"><a href="#cb22-6"></a></span>
<span id="cb22-7"><a href="#cb22-7"></a><span class="co"># create decision variables</span></span>
<span id="cb22-8"><a href="#cb22-8"></a>x <span class="op">=</span> solver.NumVar(<span class="fl">1.0</span>, solver.Infinity(), <span class="st">"x"</span>)</span>
<span id="cb22-9"><a href="#cb22-9"></a>y <span class="op">=</span> solver.NumVar(<span class="fl">1.0</span>, solver.Infinity(), <span class="st">"y"</span>)</span>
<span id="cb22-10"><a href="#cb22-10"></a></span>
<span id="cb22-11"><a href="#cb22-11"></a><span class="co"># create constraints</span></span>
<span id="cb22-12"><a href="#cb22-12"></a>constr <span class="op">=</span> solver.Add(x <span class="op">+</span> y <span class="op">&lt;=</span> <span class="dv">10</span>)</span>
<span id="cb22-13"><a href="#cb22-13"></a></span>
<span id="cb22-14"><a href="#cb22-14"></a><span class="co"># create objective</span></span>
<span id="cb22-15"><a href="#cb22-15"></a>solver.Maximize(x <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> y)</span>
<span id="cb22-16"><a href="#cb22-16"></a></span>
<span id="cb22-17"><a href="#cb22-17"></a><span class="co"># solve the problem</span></span>
<span id="cb22-18"><a href="#cb22-18"></a>status <span class="op">=</span> solver.Solve()</span>
<span id="cb22-19"><a href="#cb22-19"></a></span>
<span id="cb22-20"><a href="#cb22-20"></a><span class="cf">if</span> status <span class="op">==</span> pywraplp.Solver.OPTIMAL <span class="kw">or</span> status <span class="op">==</span> pywraplp.Solver.FEASIBLE:</span>
<span id="cb22-21"><a href="#cb22-21"></a>    <span class="bu">print</span>(<span class="ss">f"obj = </span><span class="sc">{</span>solver<span class="sc">.</span>Objective()<span class="sc">.</span>Value()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb22-22"><a href="#cb22-22"></a>    <span class="bu">print</span>(<span class="ss">f"x = </span><span class="sc">{</span>x<span class="sc">.</span>solution_value()<span class="sc">}</span><span class="ss">, reduced cost = </span><span class="sc">{</span>x<span class="sc">.</span>reduced_cost()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb22-23"><a href="#cb22-23"></a>    <span class="bu">print</span>(<span class="ss">f"y = </span><span class="sc">{</span>y<span class="sc">.</span>solution_value()<span class="sc">}</span><span class="ss">, reduced cost = </span><span class="sc">{</span>y<span class="sc">.</span>reduced_cost()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb22-24"><a href="#cb22-24"></a>    <span class="bu">print</span>(<span class="ss">f"constr dual value = </span><span class="sc">{</span>constr<span class="sc">.</span>dual_value()<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>obj = 19.0
x = 1.0, reduced cost = -1.0
y = 9.0, reduced cost = 0.0
constr dual value = 2.0</code></pre>
</div>
</div>
<p>We can see from the output that the optimal solution is <span class="math inline">\(x = 1.0\)</span> and <span class="math inline">\(y = 9.0\)</span>, and the optimal objective is 19.0. This can also be validated from <a href="#fig-lp-example">Figure&nbsp;<span>3.1</span></a> that the optimal solution is exactly the green point that sits at the intersection of the three lines <span class="math inline">\(x = 1\)</span>, <span class="math inline">\(x + y = 10\)</span> and <span class="math inline">\(x + 2y = 19\)</span>.</p>
<p><a href="#fig-lp-example">Figure&nbsp;<span>3.1</span></a> also shows that the point (1, 1) should give us the minimal value of the objective function. To validate this, we can actually change the optimization sense of the objective function from maximization to minimization using the function <code>SetOptimizationDirection()</code>, as shown in the code below:</p>
<div class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a>solver.Objective().SetOptimizationDirection(maximize<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb24-2"><a href="#cb24-2"></a></span>
<span id="cb24-3"><a href="#cb24-3"></a>solver.Solve()</span>
<span id="cb24-4"><a href="#cb24-4"></a></span>
<span id="cb24-5"><a href="#cb24-5"></a><span class="bu">print</span>(<span class="ss">f"obj = </span><span class="sc">{</span>solver<span class="sc">.</span>Objective()<span class="sc">.</span>Value()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-6"><a href="#cb24-6"></a><span class="bu">print</span>(<span class="ss">f"x = </span><span class="sc">{</span>x<span class="sc">.</span>solution_value()<span class="sc">}</span><span class="ss">, reduced cost = </span><span class="sc">{</span>x<span class="sc">.</span>reduced_cost()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-7"><a href="#cb24-7"></a><span class="bu">print</span>(<span class="ss">f"y = </span><span class="sc">{</span>y<span class="sc">.</span>solution_value()<span class="sc">}</span><span class="ss">, reduced cost = </span><span class="sc">{</span>y<span class="sc">.</span>reduced_cost()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-8"><a href="#cb24-8"></a><span class="bu">print</span>(<span class="ss">f"constr dual value = </span><span class="sc">{</span>constr<span class="sc">.</span>dual_value()<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>obj = 3.0
x = 1.0, reduced cost = 1.0
y = 1.0, reduced cost = 2.0
constr dual value = 0.0</code></pre>
</div>
</div>
</section>
<section id="transportation-problem" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="transportation-problem"><span class="header-section-number">3.2.2</span> Transportation Problem</h3>
<p>The transportation problem involves moving goods from its sources <span class="math inline">\(\mathcal{S}\)</span> to destinations <span class="math inline">\(\mathcal{D}\)</span>. Each source <span class="math inline">\(s \in \mathcal{S}\)</span> has a total amount of goods <span class="math inline">\(p_s\)</span> it could supply, and each destination <span class="math inline">\(s \in \mathcal{D}\)</span> has a certain amount of demands <span class="math inline">\(m_d\)</span>. There is a transportation cost, denoted by <span class="math inline">\(c_{sd}\)</span>, to move one unit of goods from a source to a destination. The problem is to find the best set of goods to move from each source to each destination such that all the destination demands are met with the lowest transportation costs.</p>
<p>To model this transportation problem, we define the decision variable <span class="math inline">\(x_{sd}\)</span> to be the amount of goods moving from source <span class="math inline">\(s\)</span> to destinaiton <span class="math inline">\(d\)</span>. Then we could state the problem mathematically as below.</p>
<p><span class="math display">\[\begin{align}
\text{min.} &amp;\quad \sum_{s \in \mathcal{S}} \sum_{d \in \mathcal{D}} c_{sd} x_{sd} \label{tp-obj} \\
\text{s.t.} &amp; \quad \sum_{d \in \mathcal{D}} x_{sd} = p_s, \ \forall s \in \mathcal{S} \label{tp-cons1} \\
&amp; \sum_{s \in \mathcal{S}} x_{sd} = m_d, \ \forall d \in \mathcal{D} \label{tp-cons2} \\
&amp; x_{sd} \geq 0, \ \forall s \in \mathcal{S}, d \in \mathcal{D} \label{tp-cons3}
\end{align}\]</span></p>
<p>The objective function <span class="math inline">\(\eqref{tp-obj}\)</span> aims to minimize the total transportation costs going from all sources to all destinations. Constraints <span class="math inline">\(\eqref{tp-cons1}\)</span> make sure that the sum of goods leaving a source node <span class="math inline">\(s\)</span> must equal to its available supply <span class="math inline">\(p_s\)</span>. Constraints <span class="math inline">\(\eqref{tp-cons2}\)</span> require that the sum of goods gonig to a destination node <span class="math inline">\(d\)</span> must equal to its demand <span class="math inline">\(m_d\)</span>. Constraints <span class="math inline">\(\eqref{tp-cons3}\)</span> state that the flow variables from sources to destination can only be nonnegative values.</p>
<p><a href="#tbl-tp">Table&nbsp;<span>3.1</span></a> shows an instance of the transportation problem in which there are four sources and five destinations. Entries in the last row give the corresponding demand from each destination, and the last column list the available supply at each source. The entries in the middle of the table show the transportation cost associated with moving from a specific source to a specific destination. For example, it costs $18 to move one unit of good from source S2 to D3.</p>
<div class="cell" data-execution_count="80">
<div class="cell-output cell-output-display" data-execution_count="80">
<div id="tbl-tp" class="anchored">
<table class="table table-sm table-striped small">
<caption>Table&nbsp;3.1: A transportation problem</caption>
<thead>
<tr class="header">
<th></th>
<th style="text-align: right;">D1</th>
<th style="text-align: right;">D2</th>
<th style="text-align: right;">D3</th>
<th style="text-align: right;">D4</th>
<th style="text-align: right;">D5</th>
<th style="text-align: right;">Supply</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>S1</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">58</td>
</tr>
<tr class="even">
<td>S2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">55</td>
</tr>
<tr class="odd">
<td>S3</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">64</td>
</tr>
<tr class="even">
<td>S4</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">71</td>
</tr>
<tr class="odd">
<td>Demand</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">88</td>
<td style="text-align: right;">248</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>We show here two modeling flavors of using OR-Tools to solve this problem. In the first approach, decision variables are created using the <code>NumVar()</code> function, cnostraints are defined using the <code>Add()</code> function and the objective function is added using the <code>Minimize()</code> function. Note that both constraints and the objective function are generated with the help of of <code>Sum()</code> function that creates an expression.</p>
<div class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a><span class="im">from</span> ortools.linear_solver <span class="im">import</span> pywraplp</span>
<span id="cb26-2"><a href="#cb26-2"></a></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="co"># gather data</span></span>
<span id="cb26-4"><a href="#cb26-4"></a>num_sources <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb26-5"><a href="#cb26-5"></a>num_destinations <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb26-6"><a href="#cb26-6"></a>supplies <span class="op">=</span> [<span class="dv">58</span>, <span class="dv">55</span>, <span class="dv">64</span>, <span class="dv">71</span>]</span>
<span id="cb26-7"><a href="#cb26-7"></a>demands <span class="op">=</span> [<span class="dv">44</span>, <span class="dv">28</span>, <span class="dv">36</span>, <span class="dv">52</span>, <span class="dv">88</span>]</span>
<span id="cb26-8"><a href="#cb26-8"></a>costs <span class="op">=</span> [[<span class="dv">8</span>, <span class="dv">5</span>, <span class="dv">13</span>, <span class="dv">12</span>, <span class="dv">12</span>], </span>
<span id="cb26-9"><a href="#cb26-9"></a>        [<span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">6</span>, <span class="dv">5</span>], </span>
<span id="cb26-10"><a href="#cb26-10"></a>        [<span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">5</span>, <span class="dv">11</span>, <span class="dv">18</span>], </span>
<span id="cb26-11"><a href="#cb26-11"></a>        [<span class="dv">19</span>, <span class="dv">13</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">18</span>]]</span>
<span id="cb26-12"><a href="#cb26-12"></a></span>
<span id="cb26-13"><a href="#cb26-13"></a><span class="co"># create solver</span></span>
<span id="cb26-14"><a href="#cb26-14"></a>solver <span class="op">=</span> pywraplp.Solver.CreateSolver(<span class="st">"GLOP"</span>)</span>
<span id="cb26-15"><a href="#cb26-15"></a></span>
<span id="cb26-16"><a href="#cb26-16"></a><span class="co"># create decision variables</span></span>
<span id="cb26-17"><a href="#cb26-17"></a>var_flow <span class="op">=</span> []</span>
<span id="cb26-18"><a href="#cb26-18"></a><span class="cf">for</span> src_idx <span class="kw">in</span> <span class="bu">range</span>(num_sources):</span>
<span id="cb26-19"><a href="#cb26-19"></a>    <span class="bu">vars</span> <span class="op">=</span> [</span>
<span id="cb26-20"><a href="#cb26-20"></a>        solver.NumVar(<span class="dv">0</span>, solver.Infinity(), </span>
<span id="cb26-21"><a href="#cb26-21"></a>                    name<span class="op">=</span><span class="ss">f"var_</span><span class="sc">{</span>src_idx<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>dest_idx<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-22"><a href="#cb26-22"></a>        <span class="cf">for</span> dest_idx <span class="kw">in</span> <span class="bu">range</span>(num_destinations)</span>
<span id="cb26-23"><a href="#cb26-23"></a>    ]</span>
<span id="cb26-24"><a href="#cb26-24"></a>    var_flow.append(<span class="bu">vars</span>)</span>
<span id="cb26-25"><a href="#cb26-25"></a></span>
<span id="cb26-26"><a href="#cb26-26"></a><span class="co"># create constraints</span></span>
<span id="cb26-27"><a href="#cb26-27"></a><span class="cf">for</span> src_idx <span class="kw">in</span> <span class="bu">range</span>(num_sources):</span>
<span id="cb26-28"><a href="#cb26-28"></a>    expr <span class="op">=</span> [var_flow[src_idx][dest_idx] </span>
<span id="cb26-29"><a href="#cb26-29"></a>            <span class="cf">for</span> dest_idx <span class="kw">in</span> <span class="bu">range</span>(num_destinations)]</span>
<span id="cb26-30"><a href="#cb26-30"></a>    solver.Add(solver.Sum(expr) <span class="op">==</span> supplies[src_idx])</span>
<span id="cb26-31"><a href="#cb26-31"></a></span>
<span id="cb26-32"><a href="#cb26-32"></a><span class="cf">for</span> dest_idx <span class="kw">in</span> <span class="bu">range</span>(num_destinations):</span>
<span id="cb26-33"><a href="#cb26-33"></a>    expr <span class="op">=</span> [var_flow[src_idx][dest_idx] </span>
<span id="cb26-34"><a href="#cb26-34"></a>            <span class="cf">for</span> src_idx <span class="kw">in</span> <span class="bu">range</span>(num_sources)]</span>
<span id="cb26-35"><a href="#cb26-35"></a>    solver.Add(solver.Sum(expr) <span class="op">==</span> demands[dest_idx])</span>
<span id="cb26-36"><a href="#cb26-36"></a></span>
<span id="cb26-37"><a href="#cb26-37"></a><span class="co"># create objective function</span></span>
<span id="cb26-38"><a href="#cb26-38"></a>obj_expr <span class="op">=</span> []</span>
<span id="cb26-39"><a href="#cb26-39"></a><span class="cf">for</span> src_idx <span class="kw">in</span> <span class="bu">range</span>(num_sources):</span>
<span id="cb26-40"><a href="#cb26-40"></a>    <span class="cf">for</span> dest_idx <span class="kw">in</span> <span class="bu">range</span>(num_destinations):</span>
<span id="cb26-41"><a href="#cb26-41"></a>        obj_expr.append(var_flow[src_idx][dest_idx] <span class="op">*</span> costs[src_idx][dest_idx])</span>
<span id="cb26-42"><a href="#cb26-42"></a>solver.Minimize(solver.Sum(obj_expr))</span>
<span id="cb26-43"><a href="#cb26-43"></a></span>
<span id="cb26-44"><a href="#cb26-44"></a>status <span class="op">=</span> solver.Solve()</span>
<span id="cb26-45"><a href="#cb26-45"></a></span>
<span id="cb26-46"><a href="#cb26-46"></a>opt_flow <span class="op">=</span> []</span>
<span id="cb26-47"><a href="#cb26-47"></a><span class="cf">if</span> status <span class="op">==</span> pywraplp.Solver.OPTIMAL:</span>
<span id="cb26-48"><a href="#cb26-48"></a>    <span class="bu">print</span>(<span class="ss">f"optimal obj = </span><span class="sc">{</span>solver<span class="sc">.</span>Objective()<span class="sc">.</span>Value()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-49"><a href="#cb26-49"></a>    <span class="cf">for</span> src_idx <span class="kw">in</span> <span class="bu">range</span>(num_sources):</span>
<span id="cb26-50"><a href="#cb26-50"></a>        opt_vals <span class="op">=</span> [var_flow[src_idx][dest_idx].solution_value()</span>
<span id="cb26-51"><a href="#cb26-51"></a>                    <span class="cf">for</span> dest_idx <span class="kw">in</span> <span class="bu">range</span>(num_destinations)]</span>
<span id="cb26-52"><a href="#cb26-52"></a>        opt_flow.append(opt_vals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>optimal obj = 2013.0</code></pre>
</div>
</div>
<p>The optimal solution is shown in <a href="#tbl-tp-sol1">Table&nbsp;<span>3.2</span></a>.</p>
<div class="cell" data-execution_count="82">
<div class="cell-output cell-output-display" data-execution_count="82">
<div id="tbl-tp-sol1" class="anchored">
<table class="table table-sm table-striped small">
<caption>Table&nbsp;3.2: The optimal solution</caption>
<thead>
<tr class="header">
<th></th>
<th style="text-align: right;">D1</th>
<th style="text-align: right;">D2</th>
<th style="text-align: right;">D3</th>
<th style="text-align: right;">D4</th>
<th style="text-align: right;">D5</th>
<th style="text-align: right;">Supply</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>S1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">58</td>
</tr>
<tr class="even">
<td>S2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">55</td>
</tr>
<tr class="odd">
<td>S3</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">64</td>
</tr>
<tr class="even">
<td>S4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">71</td>
</tr>
<tr class="odd">
<td>Demand</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">88</td>
<td style="text-align: right;">248</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>In the second approach shown in the code snippet below, decision variables are created with the <code>Var(integer=False)</code> method instead of the <code>NumVar()</code> method. In addition, both constraints and the objective function are created using the <code>SetCoefficient()</code> method. In the case of constraints, a lower bound and upper bound are used to generated an empty constraint, and variables are then added to the constraint one by one with their corresponding coefficient. In the case of the objective function, an empty objective is first initialized and variables are then added to it sequentially. Note that the optimization sense is set using the <code>SetMinimization()</code> function.</p>
<div class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1"></a><span class="im">from</span> ortools.linear_solver <span class="im">import</span> pywraplp</span>
<span id="cb28-2"><a href="#cb28-2"></a></span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="co"># gather data</span></span>
<span id="cb28-4"><a href="#cb28-4"></a>num_sources <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb28-5"><a href="#cb28-5"></a>num_destinations <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb28-6"><a href="#cb28-6"></a>supplies <span class="op">=</span> [<span class="dv">58</span>, <span class="dv">55</span>, <span class="dv">64</span>, <span class="dv">71</span>]</span>
<span id="cb28-7"><a href="#cb28-7"></a>demands <span class="op">=</span> [<span class="dv">44</span>, <span class="dv">28</span>, <span class="dv">36</span>, <span class="dv">52</span>, <span class="dv">88</span>]</span>
<span id="cb28-8"><a href="#cb28-8"></a>costs <span class="op">=</span> [[<span class="dv">8</span>, <span class="dv">5</span>, <span class="dv">13</span>, <span class="dv">12</span>, <span class="dv">12</span>], </span>
<span id="cb28-9"><a href="#cb28-9"></a>        [<span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">6</span>, <span class="dv">5</span>], </span>
<span id="cb28-10"><a href="#cb28-10"></a>        [<span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">5</span>, <span class="dv">11</span>, <span class="dv">18</span>],</span>
<span id="cb28-11"><a href="#cb28-11"></a>        [<span class="dv">19</span>, <span class="dv">13</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">18</span>]]</span>
<span id="cb28-12"><a href="#cb28-12"></a></span>
<span id="cb28-13"><a href="#cb28-13"></a><span class="co"># create solver</span></span>
<span id="cb28-14"><a href="#cb28-14"></a>solver <span class="op">=</span> pywraplp.Solver.CreateSolver(<span class="st">"GLOP"</span>)</span>
<span id="cb28-15"><a href="#cb28-15"></a></span>
<span id="cb28-16"><a href="#cb28-16"></a><span class="co"># create decision variables</span></span>
<span id="cb28-17"><a href="#cb28-17"></a>var_flow <span class="op">=</span> []</span>
<span id="cb28-18"><a href="#cb28-18"></a><span class="cf">for</span> src_idx <span class="kw">in</span> <span class="bu">range</span>(num_sources):</span>
<span id="cb28-19"><a href="#cb28-19"></a>    <span class="bu">vars</span> <span class="op">=</span> [</span>
<span id="cb28-20"><a href="#cb28-20"></a>        solver.Var(</span>
<span id="cb28-21"><a href="#cb28-21"></a>            <span class="dv">0</span>, solver.Infinity(), integer<span class="op">=</span><span class="va">False</span>, </span>
<span id="cb28-22"><a href="#cb28-22"></a>            name<span class="op">=</span><span class="ss">f"var_</span><span class="sc">{</span>src_idx<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>dest_idx<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb28-23"><a href="#cb28-23"></a>        )</span>
<span id="cb28-24"><a href="#cb28-24"></a>        <span class="cf">for</span> dest_idx <span class="kw">in</span> <span class="bu">range</span>(num_destinations)</span>
<span id="cb28-25"><a href="#cb28-25"></a>    ]</span>
<span id="cb28-26"><a href="#cb28-26"></a>    var_flow.append(<span class="bu">vars</span>)</span>
<span id="cb28-27"><a href="#cb28-27"></a></span>
<span id="cb28-28"><a href="#cb28-28"></a><span class="co"># create constraints</span></span>
<span id="cb28-29"><a href="#cb28-29"></a><span class="cf">for</span> src_idx <span class="kw">in</span> <span class="bu">range</span>(num_sources):</span>
<span id="cb28-30"><a href="#cb28-30"></a>    constr <span class="op">=</span> solver.Constraint(supplies[src_idx], supplies[src_idx])</span>
<span id="cb28-31"><a href="#cb28-31"></a>    <span class="cf">for</span> dest_idx <span class="kw">in</span> <span class="bu">range</span>(num_destinations):</span>
<span id="cb28-32"><a href="#cb28-32"></a>        constr.SetCoefficient(var_flow[src_idx][dest_idx], <span class="fl">1.0</span>)</span>
<span id="cb28-33"><a href="#cb28-33"></a></span>
<span id="cb28-34"><a href="#cb28-34"></a><span class="cf">for</span> dest_idx <span class="kw">in</span> <span class="bu">range</span>(num_destinations):</span>
<span id="cb28-35"><a href="#cb28-35"></a>    constr <span class="op">=</span> solver.Constraint(demands[dest_idx], demands[dest_idx])</span>
<span id="cb28-36"><a href="#cb28-36"></a>    <span class="cf">for</span> src_idx <span class="kw">in</span> <span class="bu">range</span>(num_sources):</span>
<span id="cb28-37"><a href="#cb28-37"></a>        constr.SetCoefficient(var_flow[src_idx][dest_idx], <span class="fl">1.0</span>)</span>
<span id="cb28-38"><a href="#cb28-38"></a></span>
<span id="cb28-39"><a href="#cb28-39"></a><span class="co"># create objective function</span></span>
<span id="cb28-40"><a href="#cb28-40"></a>obj <span class="op">=</span> solver.Objective()</span>
<span id="cb28-41"><a href="#cb28-41"></a><span class="cf">for</span> src_idx <span class="kw">in</span> <span class="bu">range</span>(num_sources):</span>
<span id="cb28-42"><a href="#cb28-42"></a>    <span class="cf">for</span> dest_idx <span class="kw">in</span> <span class="bu">range</span>(num_destinations):</span>
<span id="cb28-43"><a href="#cb28-43"></a>        obj.SetCoefficient(var_flow[src_idx][dest_idx], costs[src_idx][dest_idx])</span>
<span id="cb28-44"><a href="#cb28-44"></a>obj.SetMinimization()</span>
<span id="cb28-45"><a href="#cb28-45"></a></span>
<span id="cb28-46"><a href="#cb28-46"></a>status <span class="op">=</span> solver.Solve()</span>
<span id="cb28-47"><a href="#cb28-47"></a></span>
<span id="cb28-48"><a href="#cb28-48"></a>opt_flow <span class="op">=</span> []</span>
<span id="cb28-49"><a href="#cb28-49"></a><span class="cf">if</span> status <span class="op">==</span> pywraplp.Solver.OPTIMAL:</span>
<span id="cb28-50"><a href="#cb28-50"></a>    <span class="bu">print</span>(<span class="ss">f"optimal obj = </span><span class="sc">{</span>solver<span class="sc">.</span>Objective()<span class="sc">.</span>Value()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb28-51"><a href="#cb28-51"></a>    <span class="cf">for</span> src_idx <span class="kw">in</span> <span class="bu">range</span>(num_sources):</span>
<span id="cb28-52"><a href="#cb28-52"></a>        opt_vals <span class="op">=</span> [var_flow[src_idx][dest_idx].solution_value()</span>
<span id="cb28-53"><a href="#cb28-53"></a>                    <span class="cf">for</span> dest_idx <span class="kw">in</span> <span class="bu">range</span>(num_destinations)]</span>
<span id="cb28-54"><a href="#cb28-54"></a>        opt_flow.append(opt_vals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>optimal obj = 2013.0</code></pre>
</div>
</div>
<p>To validate the results, <a href="#tbl-tp-sol2">Table&nbsp;<span>3.3</span></a> shows the optimal solution produced by the second modeling approach, which is the same as in the previous approach.</p>
<div class="cell" data-execution_count="84">
<div class="cell-output cell-output-display" data-execution_count="84">
<div id="tbl-tp-sol2" class="anchored">
<table class="table table-sm table-striped small">
<caption>Table&nbsp;3.3: The optimal solution</caption>
<thead>
<tr class="header">
<th></th>
<th style="text-align: right;">D1</th>
<th style="text-align: right;">D2</th>
<th style="text-align: right;">D3</th>
<th style="text-align: right;">D4</th>
<th style="text-align: right;">D5</th>
<th style="text-align: right;">Supply</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>S1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">58</td>
</tr>
<tr class="even">
<td>S2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">55</td>
</tr>
<tr class="odd">
<td>S3</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">64</td>
</tr>
<tr class="even">
<td>S4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">71</td>
</tr>
<tr class="odd">
<td>Demand</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">88</td>
<td style="text-align: right;">248</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="resource-allocation-problem" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="resource-allocation-problem"><span class="header-section-number">3.2.3</span> Resource Allocation Problem</h3>
<p>The resource allocation problems involves distributing scarce resources among alternative activities. The resources could be machines in a manufacturing facility, money available to spend, or CPU runtime. The activities could be anything that brings profit at the cost of consuming resources. The objective of this problem is therefore to allocate the available resources to activities such that the total profit is maximized.</p>
<p>Here, we give a general resource allocation model devoid of any practical meanings. To this end, we define a few input parameters to this problem:</p>
<ul>
<li><span class="math inline">\(\mathcal{A}\)</span>: the set of candidate activities</li>
<li><span class="math inline">\(\mathcal{R}\)</span>: the set of avaiable resources</li>
<li><span class="math inline">\(p_a\)</span>: the profit of performing one unit of activity <span class="math inline">\(a \in \mathcal{A}\)</span></li>
<li><span class="math inline">\(c_{ar}\)</span>: the amount of resource <span class="math inline">\(r \in \mathcal{R}\)</span> required by one unit of activity <span class="math inline">\(a \in \mathcal{A}\)</span></li>
<li><span class="math inline">\(b_r\)</span>: the total amount of available quantities for resource <span class="math inline">\(r \in \mathcal{R}\)</span></li>
</ul>
<p>The decision variable <span class="math inline">\(x_a\)</span> represents the amount of activity <span class="math inline">\(a \in \mathcal{A}\)</span> we select to perform, and the mathematical mode is defined below:</p>
<p><span class="math display">\[\begin{align}
\text{max.} &amp;\quad \sum_{a \in \mathcal{A}} p_a x_a \label{ra-obj} \\
\text{s.t.} &amp; \quad \sum_{a \in \mathcal{A}} c_{ar} \leq b_r, \ \forall r \in \mathcal{R} \label{ra-cons1} \\
&amp; x_a \geq 0, \ a \in \mathcal{A}
\end{align}\]</span></p>
<p><a href="#tbl-resource-allocation-data">Table&nbsp;<span>3.4</span></a> shows an instance of the resource allocation problem, in which there are three type of resources and five candidate activities. The last row gives the profit of performing each unit of an activity, while the last column shows the available amount of resources. The remaining entries in the table refer to the resource consumption for each activity. For example, selecting one unit of activity 1 (A1) requires 90, 64 and 55 units of resources R1, R2 and R3, respectively.</p>
<div class="cell" data-execution_count="85">
<div class="cell-output cell-output-display" data-execution_count="85">
<div id="tbl-resource-allocation-data" class="anchored">
<table class="table table-sm table-striped small">
<caption>Table&nbsp;3.4: A resource allocation problem</caption>
<thead>
<tr class="header">
<th></th>
<th style="text-align: right;">A1</th>
<th style="text-align: right;">A2</th>
<th style="text-align: right;">A3</th>
<th style="text-align: right;">A4</th>
<th style="text-align: right;">A5</th>
<th style="text-align: right;">Available</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>R1</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">57</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">97</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">2001</td>
</tr>
<tr class="even">
<td>R2</td>
<td style="text-align: right;">64</td>
<td style="text-align: right;">58</td>
<td style="text-align: right;">97</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">2616</td>
</tr>
<tr class="odd">
<td>R3</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">87</td>
<td style="text-align: right;">77</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">1691</td>
</tr>
<tr class="even">
<td>Profit</td>
<td style="text-align: right;">1223</td>
<td style="text-align: right;">1238</td>
<td style="text-align: right;">1517</td>
<td style="text-align: right;">1616</td>
<td style="text-align: right;">1027</td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>In the code snippet below, we use Google OR-Tools to solve this problem instance. Again, we start with initializing a solver object, follwed by creation of five decision variables, one for each activity. Both the constraints and objective function are created using the first modeling approach demonstrated previously. The optimal solution is outputed in the end.</p>
<div class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1"></a><span class="im">from</span> ortools.linear_solver <span class="im">import</span> pywraplp</span>
<span id="cb30-2"><a href="#cb30-2"></a></span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="co"># gather instance data</span></span>
<span id="cb30-4"><a href="#cb30-4"></a>num_resources <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb30-5"><a href="#cb30-5"></a>num_activities <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb30-6"><a href="#cb30-6"></a>profits <span class="op">=</span> [<span class="dv">1223</span>, <span class="dv">1238</span>, <span class="dv">1517</span>, <span class="dv">1616</span>, <span class="dv">1027</span>]</span>
<span id="cb30-7"><a href="#cb30-7"></a>available_resources <span class="op">=</span> [<span class="dv">2001</span>, <span class="dv">2616</span>, <span class="dv">1691</span>]</span>
<span id="cb30-8"><a href="#cb30-8"></a>costs <span class="op">=</span> [[<span class="dv">90</span>, <span class="dv">57</span>, <span class="dv">51</span>, <span class="dv">97</span>, <span class="dv">67</span>],</span>
<span id="cb30-9"><a href="#cb30-9"></a>        [<span class="dv">64</span>, <span class="dv">58</span>, <span class="dv">97</span>, <span class="dv">56</span>, <span class="dv">93</span>],</span>
<span id="cb30-10"><a href="#cb30-10"></a>        [<span class="dv">55</span>, <span class="dv">87</span>, <span class="dv">77</span>, <span class="dv">52</span>, <span class="dv">51</span>]]</span>
<span id="cb30-11"><a href="#cb30-11"></a></span>
<span id="cb30-12"><a href="#cb30-12"></a><span class="co"># initialize a solver object</span></span>
<span id="cb30-13"><a href="#cb30-13"></a>solver <span class="op">=</span> pywraplp.Solver.CreateSolver(<span class="st">"GLOP"</span>)</span>
<span id="cb30-14"><a href="#cb30-14"></a></span>
<span id="cb30-15"><a href="#cb30-15"></a>infinity <span class="op">=</span> solver.Infinity()</span>
<span id="cb30-16"><a href="#cb30-16"></a><span class="co"># create decision variables</span></span>
<span id="cb30-17"><a href="#cb30-17"></a>var_x <span class="op">=</span> [solver.NumVar(<span class="dv">0</span>, infinity, name<span class="op">=</span><span class="ss">f"x_P</span><span class="sc">{</span>a<span class="sc">}</span><span class="ss">"</span>) </span>
<span id="cb30-18"><a href="#cb30-18"></a>        <span class="cf">for</span> a <span class="kw">in</span> <span class="bu">range</span>(num_activities)]</span>
<span id="cb30-19"><a href="#cb30-19"></a></span>
<span id="cb30-20"><a href="#cb30-20"></a><span class="co"># create objective function</span></span>
<span id="cb30-21"><a href="#cb30-21"></a>solver.Maximize(solver.Sum([profits[a] <span class="op">*</span> var_x[a] </span>
<span id="cb30-22"><a href="#cb30-22"></a>                            <span class="cf">for</span> a <span class="kw">in</span> <span class="bu">range</span>(num_activities)]))</span>
<span id="cb30-23"><a href="#cb30-23"></a></span>
<span id="cb30-24"><a href="#cb30-24"></a><span class="co"># create constraints</span></span>
<span id="cb30-25"><a href="#cb30-25"></a><span class="cf">for</span> r_idx <span class="kw">in</span> <span class="bu">range</span>(num_resources):</span>
<span id="cb30-26"><a href="#cb30-26"></a>    cons <span class="op">=</span> solver.Add(</span>
<span id="cb30-27"><a href="#cb30-27"></a>            solver.Sum([costs[r_idx][a_idx] <span class="op">*</span> var_x[a_idx] </span>
<span id="cb30-28"><a href="#cb30-28"></a>                        <span class="cf">for</span> a_idx <span class="kw">in</span> <span class="bu">range</span>(num_activities)]) </span>
<span id="cb30-29"><a href="#cb30-29"></a>                      <span class="op">&lt;=</span> available_resources[r_idx])</span>
<span id="cb30-30"><a href="#cb30-30"></a>    </span>
<span id="cb30-31"><a href="#cb30-31"></a>status <span class="op">=</span> solver.Solve()</span>
<span id="cb30-32"><a href="#cb30-32"></a><span class="cf">if</span> status <span class="op">!=</span> pywraplp.Solver.OPTIMAL:</span>
<span id="cb30-33"><a href="#cb30-33"></a>    <span class="bu">print</span>(<span class="st">"solver failure!"</span>)</span>
<span id="cb30-34"><a href="#cb30-34"></a></span>
<span id="cb30-35"><a href="#cb30-35"></a><span class="bu">print</span>(<span class="st">"solve complete!"</span>)</span>
<span id="cb30-36"><a href="#cb30-36"></a>opt_obj <span class="op">=</span> solver.Objective().Value()</span>
<span id="cb30-37"><a href="#cb30-37"></a><span class="bu">print</span>(<span class="ss">f"optimal obj = </span><span class="sc">{</span>opt_obj<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb30-38"><a href="#cb30-38"></a></span>
<span id="cb30-39"><a href="#cb30-39"></a>opt_sol <span class="op">=</span> [var_x[a_idx].solution_value() </span>
<span id="cb30-40"><a href="#cb30-40"></a>           <span class="cf">for</span> a_idx <span class="kw">in</span> <span class="bu">range</span>(num_activities)]</span>
<span id="cb30-41"><a href="#cb30-41"></a><span class="cf">for</span> a_idx <span class="kw">in</span> <span class="bu">range</span>(num_activities):</span>
<span id="cb30-42"><a href="#cb30-42"></a>    <span class="bu">print</span>(<span class="ss">f"opt_x[</span><span class="sc">{</span>a_idx <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">] = </span><span class="sc">{</span>opt_sol[a_idx]<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>solve complete!
optimal obj = 41645.23
opt_x[1] = 0.00
opt_x[2] = 0.00
opt_x[3] = 12.45
opt_x[4] = 14.08
opt_x[5] = 0.00</code></pre>
</div>
</div>
</section>
<section id="workforce-planning-problem" class="level3" data-number="3.2.4">
<h3 data-number="3.2.4" class="anchored" data-anchor-id="workforce-planning-problem"><span class="header-section-number">3.2.4</span> Workforce Planning Problem</h3>
<p>In the workforce planning problem, there are a number of time periods and each period has a workforce requirement that must be satisfied. In addition, there are a set of available work patterns to assign workers to and each pattern cover one or more time periods. Note that assignment of workers to a particular pattern incurs a certain cost. The problem is then to identify the number of workers assigned to each pattern such that the total cost is minimized.</p>
<p><a href="#tbl-workforce-inst-1">Table&nbsp;<span>3.5</span></a> shows a contrived workforce planning problem instance. In this problem, there are a total of 10 time periods and there are four patterns available to assign workers to. The last row gives the work requirement in each time period and the last column shows the cost of assigning a worker to a pattern.</p>
<div id="tbl-workforce-inst-1" class="anchored">
<table class="table">
<caption>Table&nbsp;3.5: A workforce planning problem instance</caption>
<thead>
<tr class="header">
<th>Coverage</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th>8</th>
<th>9</th>
<th>10</th>
<th>Cost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Pattern 1</td>
<td>x</td>
<td>x</td>
<td>x</td>
<td>x</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>10</td>
</tr>
<tr class="even">
<td>Pattern 2</td>
<td></td>
<td></td>
<td>x</td>
<td>x</td>
<td>x</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>30</td>
</tr>
<tr class="odd">
<td>Pattern 3</td>
<td></td>
<td></td>
<td></td>
<td>x</td>
<td>x</td>
<td>x</td>
<td>x</td>
<td></td>
<td></td>
<td></td>
<td>20</td>
</tr>
<tr class="even">
<td>Pattern 4</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>x</td>
<td>x</td>
<td>x</td>
<td>x</td>
<td>40</td>
</tr>
<tr class="odd">
<td>Requirement</td>
<td>3</td>
<td>4</td>
<td>3</td>
<td>1</td>
<td>5</td>
<td>7</td>
<td>2</td>
<td>4</td>
<td>5</td>
<td>1</td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p>To model this problem, we use <span class="math inline">\(\mathcal{T}\)</span> and <span class="math inline">\(\mathcal{P}\)</span> to denote the set of time periods and patterns, respectively. The parameter <span class="math inline">\(m_{pt}\)</span> indicates whether a pattern <span class="math inline">\(p \in \mathcal{P}\)</span> covers a certain time period <span class="math inline">\(t \in \mathcal{T}\)</span>. The work requirement of each time period and the cost of assigning a pattern is represented as <span class="math inline">\(r_t\)</span> and <span class="math inline">\(c_p\)</span>, respectively.</p>
<p>Now we are ready to define the variable <span class="math inline">\(x_p\)</span> as the number of workers that are assigned to pattern <span class="math inline">\(p\)</span>, and the mathematical model can be stated as below.</p>
<p><span class="math display">\[\begin{align}
\text{min.} &amp; \quad \sum_{p \in \mathcal{P}} c_p x_p \\
\text{s.t.} &amp; \quad \sum_{p \in \mathcal{P}} m_{pt} x_p \geq r_t, \ \forall t \in \mathcal{T} \\
&amp;\quad x_p \geq 0, \ \forall p \in \mathcal{P}
\end{align}\]</span></p>
<p>The code snippet below gives the Python code to solve this problem using Google OR-Tools.</p>
<div class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1"></a><span class="im">from</span> ortools.linear_solver <span class="im">import</span> pywraplp</span>
<span id="cb32-2"><a href="#cb32-2"></a></span>
<span id="cb32-3"><a href="#cb32-3"></a><span class="co"># import instance data</span></span>
<span id="cb32-4"><a href="#cb32-4"></a>num_periods <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb32-5"><a href="#cb32-5"></a>num_patterns <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb32-6"><a href="#cb32-6"></a>requirements <span class="op">=</span> [<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">1</span>]</span>
<span id="cb32-7"><a href="#cb32-7"></a>costs <span class="op">=</span> [<span class="dv">10</span>, <span class="dv">30</span>, <span class="dv">20</span>, <span class="dv">40</span>]</span>
<span id="cb32-8"><a href="#cb32-8"></a>patterns <span class="op">=</span> [<span class="bu">set</span>([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>]),</span>
<span id="cb32-9"><a href="#cb32-9"></a>            <span class="bu">set</span>([<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]),</span>
<span id="cb32-10"><a href="#cb32-10"></a>            <span class="bu">set</span>([<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>]),</span>
<span id="cb32-11"><a href="#cb32-11"></a>            <span class="bu">set</span>([<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>])]</span>
<span id="cb32-12"><a href="#cb32-12"></a></span>
<span id="cb32-13"><a href="#cb32-13"></a><span class="co"># create solver object</span></span>
<span id="cb32-14"><a href="#cb32-14"></a>solver <span class="op">=</span> pywraplp.Solver.CreateSolver(<span class="st">'GLOP'</span>)</span>
<span id="cb32-15"><a href="#cb32-15"></a></span>
<span id="cb32-16"><a href="#cb32-16"></a>infinity <span class="op">=</span> solver.Infinity()</span>
<span id="cb32-17"><a href="#cb32-17"></a><span class="co"># create decision variables</span></span>
<span id="cb32-18"><a href="#cb32-18"></a>var_p <span class="op">=</span> [solver.NumVar(<span class="dv">0</span>, infinity, name<span class="op">=</span><span class="ss">f"x_</span><span class="sc">{</span>p<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb32-19"><a href="#cb32-19"></a>         <span class="cf">for</span> p <span class="kw">in</span> <span class="bu">range</span>(num_patterns)]</span>
<span id="cb32-20"><a href="#cb32-20"></a></span>
<span id="cb32-21"><a href="#cb32-21"></a><span class="co"># create objective function</span></span>
<span id="cb32-22"><a href="#cb32-22"></a>solver.Minimize(</span>
<span id="cb32-23"><a href="#cb32-23"></a>    solver.Sum([costs[p] <span class="op">*</span> var_p[p] </span>
<span id="cb32-24"><a href="#cb32-24"></a>                <span class="cf">for</span> p <span class="kw">in</span> <span class="bu">range</span>(num_patterns)])</span>
<span id="cb32-25"><a href="#cb32-25"></a>)</span>
<span id="cb32-26"><a href="#cb32-26"></a></span>
<span id="cb32-27"><a href="#cb32-27"></a><span class="co"># create constraints</span></span>
<span id="cb32-28"><a href="#cb32-28"></a><span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(num_periods):   </span>
<span id="cb32-29"><a href="#cb32-29"></a>    solver.Add(</span>
<span id="cb32-30"><a href="#cb32-30"></a>        solver.Sum([var_p[p] </span>
<span id="cb32-31"><a href="#cb32-31"></a>                    <span class="cf">for</span> p <span class="kw">in</span> <span class="bu">range</span>(num_patterns) </span>
<span id="cb32-32"><a href="#cb32-32"></a>                    <span class="cf">if</span> (t <span class="op">+</span> <span class="dv">1</span>) <span class="kw">in</span> patterns[p]])</span>
<span id="cb32-33"><a href="#cb32-33"></a>        <span class="op">&gt;=</span> requirements[t])</span>
<span id="cb32-34"><a href="#cb32-34"></a></span>
<span id="cb32-35"><a href="#cb32-35"></a><span class="co"># solve the problem and retrieve optimal solution</span></span>
<span id="cb32-36"><a href="#cb32-36"></a>status <span class="op">=</span> solver.Solve()</span>
<span id="cb32-37"><a href="#cb32-37"></a><span class="cf">if</span> status <span class="op">==</span> pywraplp.Solver.OPTIMAL:</span>
<span id="cb32-38"><a href="#cb32-38"></a>    <span class="bu">print</span>(<span class="ss">f"obj = </span><span class="sc">{</span>solver<span class="sc">.</span>Objective()<span class="sc">.</span>Value()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb32-39"><a href="#cb32-39"></a>    <span class="cf">for</span> p <span class="kw">in</span> <span class="bu">range</span>(num_patterns):</span>
<span id="cb32-40"><a href="#cb32-40"></a>        <span class="bu">print</span>(<span class="ss">f"var_</span><span class="sc">{</span>p <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss"> = </span><span class="sc">{</span>var_p[p]<span class="sc">.</span>solution_value()<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>obj = 380.0
var_1 = 4.0
var_2 = 0.0
var_3 = 7.0
var_4 = 5.0</code></pre>
</div>
</div>
</section>
<section id="sudoku-problem" class="level3" data-number="3.2.5">
<h3 data-number="3.2.5" class="anchored" data-anchor-id="sudoku-problem"><span class="header-section-number">3.2.5</span> Sudoku Problem</h3>
<p>In a Sudoku problem, a grid of 9x9 is given and the task is to fill all the cells with numbers 1-9. At the beginning, some of the cells are already gilled with numbers and the requirements are that the remaining cells must be filled so that each row, each column, and each of the 9 3x3 sub-grids contain all the numbers from 1 to 9 without any repitition. The difficulty level of Sudoku problems depends on the number of cells that are already filled in the grid at the beginning of the game. Problems with fewer initial digits filled are considered more challenging. <a href="#fig-sudoku-problem">Figure&nbsp;<span>3.2</span></a> illustrate a sample Sudoku problem.</p>
<div class="cell" data-execution_count="88">
<div class="cell-output cell-output-display">
<div id="fig-sudoku-problem" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="linear-programming_files/figure-html/fig-sudoku-problem-output-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3.2: A Sudoku problem</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>To model this problem, we define set <span class="math inline">\(S = (1, 2, 3, 4, 5, 6, 7, 8, 9)\)</span> and use <span class="math inline">\(i, j \in S\)</span> to index the row and column respectively. In addition, we use <span class="math inline">\(M=\{(i, j, k) | i, j, k \in S\}\)</span> to represent all the known numbers in the grid.</p>
<p>To formulate this problem, we define 9 binary variables for each cell in the 9x9 grid. Each of the 9 variables corresponds to one of the numbers in set <span class="math inline">\(S\)</span>. Formally, <span class="math inline">\(x_{ijk}\)</span> represents whether the value <span class="math inline">\(k\)</span> shows up in cell <span class="math inline">\((i, j)\)</span> of the grid. Note that <span class="math inline">\(i, j, k \in S\)</span>. The mathematical formulation can be stated as below.</p>
<p><span class="math display">\[\begin{align}
\text{min.} &amp;\quad 0 \label{sudoku-obj} \\
\text{s.t.} &amp;\quad \sum_{j \in S}x_{ijk} = 1, \ \forall i, k \in S \label{sudoku-cons1} \\
&amp;\quad \sum_{i \in S} x_{ijk} = 1, \ \forall j, k \in S \label{sudoku-cons2} \\
&amp;\quad \sum_{k \in S} x_{ijk} = 1, \ \forall i, j \in S \label{sudoku-cons3} \\
&amp;\quad \sum_{(i - 1) \times 3 + 1}^{(i - 1) \times 3 + 3} \sum_{(j - 1) \times 3 + 1}^{(j - 1) \times 3 + 3} x_{ijk} = 1, \ \forall i, j \in \{1, 2, 3\}, k \in S \label{sudoku-cons4}\\
&amp;\quad x_{ijk} = 1, \ \forall (i, j, k) \in M \label{sudoku-cons5}\\
&amp;\quad x_{ijk} \in \{0, 1\}, \ \forall i, j,k \in S
\end{align}\]</span></p>
<p>Since no feasible soution is more preferable than another, we use a constant value as the objective function, meaning any feasible soution is an optimal solution to this problem. Constraints <span class="math inline">\(\eqref{sudoku-cons1}\)</span> require that the number <span class="math inline">\(k \in S\)</span> shows up once and only once in each row of the grid. Similarly, <span class="math inline">\(\eqref{sudoku-cons2}\)</span> make sure that the number <span class="math inline">\(k \in S\)</span> shows up once and only once in each column of the grid. For each cell in the grid, only one of the numbers in <span class="math inline">\(S\)</span> can appear, which is guaranteed by constraints <span class="math inline">\(\eqref{sudoku-cons3}\)</span>. Constraints <span class="math inline">\(\eqref{sudoku-cons4}\)</span> ensure that the numbers in set <span class="math inline">\(S\)</span> show up once and only once in each of the sub-grids. Constraints <span class="math inline">\(\eqref{sudoku-cons5}\)</span> make sure that the existing numbers in the grid stay the same in the optimal solution.</p>
<p>We can then solve the problem using Google OR-Tools and the code snippet is given below.</p>
<div class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="im">from</span> ortools.linear_solver <span class="im">import</span> pywraplp</span>
<span id="cb34-3"><a href="#cb34-3"></a></span>
<span id="cb34-4"><a href="#cb34-4"></a><span class="co"># import data</span></span>
<span id="cb34-5"><a href="#cb34-5"></a>grid_size <span class="op">=</span> <span class="dv">9</span></span>
<span id="cb34-6"><a href="#cb34-6"></a>subgrid_size <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb34-7"><a href="#cb34-7"></a>M <span class="op">=</span> [[(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">6</span>)],</span>
<span id="cb34-8"><a href="#cb34-8"></a>     [(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>)],</span>
<span id="cb34-9"><a href="#cb34-9"></a>     [(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">5</span>), (<span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">3</span>), (<span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">7</span>), (<span class="dv">3</span>, <span class="dv">9</span>, <span class="dv">9</span>)],</span>
<span id="cb34-10"><a href="#cb34-10"></a>     [(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">2</span>), (<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>), (<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">4</span>), (<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">0</span>)],</span>
<span id="cb34-11"><a href="#cb34-11"></a>     [(<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">5</span>), (<span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">4</span>)],</span>
<span id="cb34-12"><a href="#cb34-12"></a>     [(<span class="dv">6</span>, <span class="dv">1</span>, <span class="dv">3</span>), (<span class="dv">6</span>, <span class="dv">2</span>, <span class="dv">5</span>), (<span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">8</span>), (<span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">9</span>)],</span>
<span id="cb34-13"><a href="#cb34-13"></a>     [(<span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">4</span>), (<span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">2</span>)],</span>
<span id="cb34-14"><a href="#cb34-14"></a>     [(<span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">5</span>)],</span>
<span id="cb34-15"><a href="#cb34-15"></a>     [(<span class="dv">9</span>, <span class="dv">1</span>, <span class="dv">8</span>), (<span class="dv">9</span>, <span class="dv">2</span>, <span class="dv">2</span>)]]</span>
<span id="cb34-16"><a href="#cb34-16"></a></span>
<span id="cb34-17"><a href="#cb34-17"></a><span class="co"># create solver</span></span>
<span id="cb34-18"><a href="#cb34-18"></a>solver <span class="op">=</span> pywraplp.Solver.CreateSolver(<span class="st">"SCIP"</span>)</span>
<span id="cb34-19"><a href="#cb34-19"></a></span>
<span id="cb34-20"><a href="#cb34-20"></a><span class="co"># # create decision variables</span></span>
<span id="cb34-21"><a href="#cb34-21"></a>sudoku_vars <span class="op">=</span> np.empty((grid_size, grid_size, grid_size), dtype<span class="op">=</span><span class="bu">object</span>)</span>
<span id="cb34-22"><a href="#cb34-22"></a><span class="cf">for</span> row <span class="kw">in</span> <span class="bu">range</span>(grid_size):</span>
<span id="cb34-23"><a href="#cb34-23"></a>     <span class="cf">for</span> col <span class="kw">in</span> <span class="bu">range</span>(grid_size):</span>
<span id="cb34-24"><a href="#cb34-24"></a>          <span class="cf">for</span> num <span class="kw">in</span> <span class="bu">range</span>(grid_size):</span>
<span id="cb34-25"><a href="#cb34-25"></a>               sudoku_vars[row][col][num] <span class="op">=</span> solver.Var(<span class="dv">0</span>, </span>
<span id="cb34-26"><a href="#cb34-26"></a>                                   <span class="dv">1</span>, </span>
<span id="cb34-27"><a href="#cb34-27"></a>                                   integer<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb34-28"><a href="#cb34-28"></a>                                   name<span class="op">=</span><span class="ss">f"x_</span><span class="sc">{</span>row<span class="sc">,</span> col<span class="sc">,</span> num<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb34-29"><a href="#cb34-29"></a></span>
<span id="cb34-30"><a href="#cb34-30"></a><span class="co"># create objective</span></span>
<span id="cb34-31"><a href="#cb34-31"></a>solver.Minimize(<span class="dv">0</span>)</span>
<span id="cb34-32"><a href="#cb34-32"></a></span>
<span id="cb34-33"><a href="#cb34-33"></a><span class="co"># create constraints</span></span>
<span id="cb34-34"><a href="#cb34-34"></a><span class="cf">for</span> row <span class="kw">in</span> <span class="bu">range</span>(grid_size):</span>
<span id="cb34-35"><a href="#cb34-35"></a>     <span class="cf">for</span> num <span class="kw">in</span> <span class="bu">range</span>(grid_size):</span>
<span id="cb34-36"><a href="#cb34-36"></a>          solver.Add(</span>
<span id="cb34-37"><a href="#cb34-37"></a>               solver.Sum([sudoku_vars[row][col][num] </span>
<span id="cb34-38"><a href="#cb34-38"></a>                              <span class="cf">for</span> col <span class="kw">in</span> <span class="bu">range</span>(grid_size)</span>
<span id="cb34-39"><a href="#cb34-39"></a>                         ]) <span class="op">==</span> <span class="dv">1</span></span>
<span id="cb34-40"><a href="#cb34-40"></a>                    )</span>
<span id="cb34-41"><a href="#cb34-41"></a></span>
<span id="cb34-42"><a href="#cb34-42"></a><span class="cf">for</span> col <span class="kw">in</span> <span class="bu">range</span>(grid_size):</span>
<span id="cb34-43"><a href="#cb34-43"></a>     <span class="cf">for</span> num <span class="kw">in</span> <span class="bu">range</span>(grid_size):</span>
<span id="cb34-44"><a href="#cb34-44"></a>          solver.Add(</span>
<span id="cb34-45"><a href="#cb34-45"></a>               solver.Sum([sudoku_vars[row][col][num] </span>
<span id="cb34-46"><a href="#cb34-46"></a>                              <span class="cf">for</span> row <span class="kw">in</span> <span class="bu">range</span>(grid_size)</span>
<span id="cb34-47"><a href="#cb34-47"></a>                         ]) <span class="op">==</span> <span class="dv">1</span></span>
<span id="cb34-48"><a href="#cb34-48"></a>                    )</span>
<span id="cb34-49"><a href="#cb34-49"></a>          </span>
<span id="cb34-50"><a href="#cb34-50"></a><span class="cf">for</span> row <span class="kw">in</span> <span class="bu">range</span>(grid_size):</span>
<span id="cb34-51"><a href="#cb34-51"></a>     <span class="cf">for</span> col <span class="kw">in</span> <span class="bu">range</span>(grid_size):</span>
<span id="cb34-52"><a href="#cb34-52"></a>          solver.Add(</span>
<span id="cb34-53"><a href="#cb34-53"></a>               solver.Sum([sudoku_vars[row][col][num] </span>
<span id="cb34-54"><a href="#cb34-54"></a>                              <span class="cf">for</span> num <span class="kw">in</span> <span class="bu">range</span>(grid_size)</span>
<span id="cb34-55"><a href="#cb34-55"></a>                         ]) <span class="op">==</span> <span class="dv">1</span></span>
<span id="cb34-56"><a href="#cb34-56"></a>                    )</span>
<span id="cb34-57"><a href="#cb34-57"></a>          </span>
<span id="cb34-58"><a href="#cb34-58"></a><span class="cf">for</span> row <span class="kw">in</span> <span class="bu">range</span>(grid_size):</span>
<span id="cb34-59"><a href="#cb34-59"></a>     known_values <span class="op">=</span> M[row]</span>
<span id="cb34-60"><a href="#cb34-60"></a>     <span class="cf">for</span> value <span class="kw">in</span> known_values:</span>
<span id="cb34-61"><a href="#cb34-61"></a>          row, col, num <span class="op">=</span> value</span>
<span id="cb34-62"><a href="#cb34-62"></a>          solver.Add(</span>
<span id="cb34-63"><a href="#cb34-63"></a>               sudoku_vars[row <span class="op">-</span> <span class="dv">1</span>][col <span class="op">-</span> <span class="dv">1</span>][num <span class="op">-</span> <span class="dv">1</span>] <span class="op">==</span> <span class="dv">1</span></span>
<span id="cb34-64"><a href="#cb34-64"></a>          )</span>
<span id="cb34-65"><a href="#cb34-65"></a></span>
<span id="cb34-66"><a href="#cb34-66"></a><span class="co"># solve the problem</span></span>
<span id="cb34-67"><a href="#cb34-67"></a>status <span class="op">=</span> solver.Solve()</span>
<span id="cb34-68"><a href="#cb34-68"></a></span>
<span id="cb34-69"><a href="#cb34-69"></a><span class="cf">if</span> status <span class="op">==</span> pywraplp.Solver.OPTIMAL <span class="kw">or</span> status <span class="op">==</span> pywraplp.Solver.FEASIBLE:</span>
<span id="cb34-70"><a href="#cb34-70"></a>     sudoku_sol <span class="op">=</span> np.zeros((grid_size, grid_size), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb34-71"><a href="#cb34-71"></a>     <span class="cf">for</span> row <span class="kw">in</span> <span class="bu">range</span>(grid_size):</span>
<span id="cb34-72"><a href="#cb34-72"></a>          <span class="cf">for</span> col <span class="kw">in</span> <span class="bu">range</span>(grid_size):</span>
<span id="cb34-73"><a href="#cb34-73"></a>               <span class="cf">for</span> num <span class="kw">in</span> <span class="bu">range</span>(grid_size):</span>
<span id="cb34-74"><a href="#cb34-74"></a>                    <span class="cf">if</span> sudoku_vars[row][col][num].solution_value() <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb34-75"><a href="#cb34-75"></a>                         sudoku_sol[row][col] <span class="op">=</span> num <span class="op">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="#fig-sudoku-sol">Figure&nbsp;<span>3.3</span></a> shows one solution to the example problem.</p>
<div class="cell" data-execution_count="91">
<div class="cell-output cell-output-display">
<div id="fig-sudoku-sol" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="linear-programming_files/figure-html/fig-sudoku-sol-output-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3.3: One solution to the Sudoku problem</figcaption><p></p>
</figure>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="kunlei/python-ortools-notes" data-repo-id="R_kgDOI-7w-A" data-category="General" data-category-id="DIC_kwDOI-7w-M4CVd98" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./env-setup.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Environment Setup</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./integer-programming.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Integer Programming</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>