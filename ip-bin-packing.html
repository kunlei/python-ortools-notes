<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.526">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Hands-on Optimization with OR-Tools in Python - 13&nbsp; The Bin Packing Problem</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ip-branch-bound.html" rel="next">
<link href="./ip-cutting-stock.html" rel="prev">
<link href="./logo.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-DTVHQH448R"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-DTVHQH448R', { 'anonymize_ip': true});
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        TeX: { equationNumbers: {autoNumber: "AMS"} },
        tex2jax: {inlineMath: [ ['$','$'], ["\\(","\\)"] ]}
    });
    </script>

<!-- This is what works with Quarto -->
<script>
    MathJax = {
        tex: {
            tags: 'ams'  // should be 'ams', 'none', or 'all'
        }
    };
</script>
<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2749302331976623" crossorigin="anonymous"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="twitter:title" content="Hands-on Optimization with OR-Tools in Python - 13&nbsp; The Bin Packing Problem">
<meta name="twitter:description" content="">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./linear-programming.html">Mathematical Programming</a></li><li class="breadcrumb-item"><a href="./ip-bin-packing.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">The Bin Packing Problem</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Hands-on Optimization with OR-Tools in Python</a> 
        <div class="sidebar-tools-main">
    <a href="https://twitter.com/intent/tweet?url=|url|" title="Twitter" class="quarto-navigation-tool px-1" aria-label="Twitter"><i class="bi bi-twitter"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">For the Impatient</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./env-setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Environment Setup</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Mathematical Programming</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear-programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Linear Programming</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./integer-programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Integer Programming</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ip-jsp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Job Shop Scheduling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ip-tsp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Traveling Salesman Problem</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ip-cvrp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Capacitated Vehicle Routing Problem</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ip-knapsack.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">The Knapsack Problem</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ip-nqueens.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">The N-queens Problem</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ip-srflp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Single Row Facility Layout Problem</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ip-wlp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Warehouse Location Problem</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ip-cutting-stock.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">The Cutting Stock Problem</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ip-bin-packing.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">The Bin Packing Problem</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ip-branch-bound.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Hands-On Branch and Bound</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./linear-programming.html">Mathematical Programming</a></li><li class="breadcrumb-item"><a href="./ip-bin-packing.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">The Bin Packing Problem</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-bin-packing" class="quarto-section-identifier"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">The Bin Packing Problem</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>The bin packing problem (BPP) is a classic optimization problem in computer science that involves packing a set of items into a minimum number of bins or containers, subject to certain constraints. The problem is also known as the container loading problem, or the bin packing optimization problem.</p>
<p>In the bin packing problem, we are given a set of items, each with a weight or size, and a set of bins, each with a fixed capacity. The goal is to pack the items into the bins such that the number of bins used is minimized.</p>
<p>The problem is NP-hard, which means that there is no known algorithm that can solve it in polynomial time. However, several heuristic algorithms have been developed that can provide good solutions in practice.</p>
<p>The bin packing problem has many real-world applications, such as optimizing the use of storage space in warehouses, minimizing the number of trucks needed for transportation, and optimizing the use of computer memory. It is also a fundamental problem in the study of computational complexity theory and has been extensively studied in the fields of operations research, computer science, and mathematics.</p>
<p>To formally express the bin packing problem (BPP), we use the notation of a set of items that need to be packed into a set of bins. The set of items is denoted as <span class="math inline">\(\mathcal{I}\)</span>, while the set of bins is denoted as <span class="math inline">\(\mathcal{J}\)</span>. Each item <span class="math inline">\(i\)</span> in <span class="math inline">\(\mathcal{I}\)</span> has a size denoted as <span class="math inline">\(s_i\)</span>, and each bin <span class="math inline">\(j\)</span> in <span class="math inline">\(\mathcal{J}\)</span> has a fixed capacity denoted as <span class="math inline">\(Q\)</span>. To solve the problem, we introduce two decision variables: <span class="math inline">\(y_j\)</span> and <span class="math inline">\(x_{ij}\)</span>.</p>
<ul>
<li>The variable <span class="math inline">\(y_j\)</span> is a binary variable that takes the value 1 if the bin <span class="math inline">\(j\)</span> is used and 0 otherwise.</li>
<li>The variable <span class="math inline">\(x_{ij}\)</span> is a binary variable that takes the value 1 if item <span class="math inline">\(i\)</span> is placed into bin <span class="math inline">\(j\)</span> and 0 otherwise.</li>
</ul>
<p>Using these decision variables, the BPP can be formulated as follows.</p>
<p><span class="math display">\[\begin{align}
    \text{min.} &amp;\quad \sum_{j \in \mathcal{J}} y_j \label{bin-obj} \\
    \text{s.t.} &amp;\quad \sum_{i \in \mathcal{I}} s_i x_{ij} \leq Q y_j, \ \forall j \in \mathcal{J} \label{bin-cons1} \\
    &amp;\quad \sum_{j \in \mathcal{J}} x_{ij} = 1, \ \forall i \in \mathcal{I} \label{bin-cons2} \\
    &amp;\quad y_j \in \{0, 1\}, \ \forall j \in \mathcal{J} \label{bin-cons3} \\
    &amp;\quad x_{ij} \in \{0, 1\}, \ \forall i \in \mathcal{I}, j \in \mathcal{J} \label{bin-cons4}
\end{align}\]</span></p>
<p>The objective function of the problem is to minimize the number of bins used, which is represented by the summation of the binary decision variable <span class="math inline">\(y_j\)</span>, where <span class="math inline">\(j\)</span> denotes the bins used in the solution.</p>
<p>The problem has four constraints that need to be satisfied. The first constraint (<span class="math inline">\(\ref{bin-cons1}\)</span>) ensures that the total size of items placed in each bin <span class="math inline">\(j\)</span> does not exceed its capacity <span class="math inline">\(Q\)</span>, multiplied by the binary decision variable <span class="math inline">\(y_j\)</span>. This constraint ensures that items are only placed in bins that are actually used, i.e., those for which <span class="math inline">\(y_j=1\)</span>. The second constraint (<span class="math inline">\(\ref{bin-cons2}\)</span>) ensures that each item is placed in exactly one bin. The third constraint (<span class="math inline">\(\ref{bin-cons3}\)</span>) restricts the binary variable <span class="math inline">\(y_j\)</span> to only take the values 0 or 1. This constraint ensures that only the used bins are counted in the objective function. The fourth constraint (<span class="math inline">\(\ref{bin-cons4}\)</span>) restricts the binary variable <span class="math inline">\(x_{ij}\)</span> to only take the values 0 or 1. This constraint ensures that each item is either placed in a bin or not.</p>
<p>The following Python class <code>BppDataCenter</code> is designed to hold data for an instance of the bin packing problem. The constructor of the class takes in four arguments: <code>num_bins</code>, <code>num_items</code>, <code>bin_capacity</code>, and <code>item_sizes</code>.</p>
<ul>
<li><code>num_bins</code> is an integer that specifies the number of bins available in the problem instance.</li>
<li><code>num_items</code> is an integer that specifies the number of items that need to be packed into the bins.</li>
<li><code>bin_capacity</code> is an integer that specifies the maximum capacity of each bin.</li>
<li><code>item_sizes</code> is a list of integers that specifies the size of each item.</li>
</ul>
<p>The class has four properties that allow access to the instance variables:</p>
<ul>
<li><code>num_bins</code> returns the number of bins.</li>
<li><code>num_items</code> returns the number of items.</li>
<li><code>bin_capacity</code> returns the maximum capacity of each bin.</li>
<li><code>item_sizes</code> returns the list of item sizes.</li>
</ul>
<p>Overall, this class is a convenient way to encapsulate the data of a bin packing problem instance in a single object, making it easier to pass the data to functions or algorithms that solve the problem.</p>
<div id="cell-7" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">class</span> BppDataCenter:</span>
<span id="cb1-2"><a href="#cb1-2"></a>    </span>
<span id="cb1-3"><a href="#cb1-3"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, num_bins,</span>
<span id="cb1-4"><a href="#cb1-4"></a>                num_items,</span>
<span id="cb1-5"><a href="#cb1-5"></a>                bin_capacity,</span>
<span id="cb1-6"><a href="#cb1-6"></a>                item_sizes):</span>
<span id="cb1-7"><a href="#cb1-7"></a>        <span class="va">self</span>._num_bins <span class="op">=</span> num_bins</span>
<span id="cb1-8"><a href="#cb1-8"></a>        <span class="va">self</span>._num_items <span class="op">=</span> num_items</span>
<span id="cb1-9"><a href="#cb1-9"></a>        <span class="va">self</span>._bin_capacity <span class="op">=</span> bin_capacity</span>
<span id="cb1-10"><a href="#cb1-10"></a>        <span class="va">self</span>._item_sizes <span class="op">=</span> item_sizes</span>
<span id="cb1-11"><a href="#cb1-11"></a>        </span>
<span id="cb1-12"><a href="#cb1-12"></a>    <span class="at">@property</span></span>
<span id="cb1-13"><a href="#cb1-13"></a>    <span class="kw">def</span> num_bins(<span class="va">self</span>): <span class="cf">return</span> <span class="va">self</span>._num_bins</span>
<span id="cb1-14"><a href="#cb1-14"></a>    </span>
<span id="cb1-15"><a href="#cb1-15"></a>    <span class="at">@property</span></span>
<span id="cb1-16"><a href="#cb1-16"></a>    <span class="kw">def</span> num_items(<span class="va">self</span>): <span class="cf">return</span> <span class="va">self</span>._num_items</span>
<span id="cb1-17"><a href="#cb1-17"></a>    </span>
<span id="cb1-18"><a href="#cb1-18"></a>    <span class="at">@property</span></span>
<span id="cb1-19"><a href="#cb1-19"></a>    <span class="kw">def</span> bin_capacity(<span class="va">self</span>): <span class="cf">return</span> <span class="va">self</span>._bin_capacity</span>
<span id="cb1-20"><a href="#cb1-20"></a>    </span>
<span id="cb1-21"><a href="#cb1-21"></a>    <span class="at">@property</span></span>
<span id="cb1-22"><a href="#cb1-22"></a>    <span class="kw">def</span> item_sizes(<span class="va">self</span>): <span class="cf">return</span> <span class="va">self</span>._item_sizes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This Python class <code>BppSolver</code> uses the Google OR-Tools library to solve the Bin Packing Problem. It takes an instance of <code>BppDataCenter</code> class as input, which holds the problem data. The class has several methods to build the optimization model, solve it, and return the optimal objective value, variables and constraints.</p>
<p>The <code>build_model()</code> method creates the optimization model by first initializing a solver object, then creating decision variables using Boolean variables <code>BoolVar()</code>, defining the objective function using the <code>Minimize()</code> method, and defining constraints using the <code>Add()</code> method.</p>
<p>The <code>optimize()</code> method solves the optimization model using the <code>Solve()</code> method of the solver object, and returns the optimal objective value, variables, and constraints. It uses the <code>solution_value()</code> method of the variables to extract the optimal values of the variables.</p>
<p>The <code>create_variables()</code> method creates decision variables for the model using <code>BoolVar()</code> method from the solver object. It creates binary variables <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span> for the problem. Variable <span class="math inline">\(y\)</span> indicates whether a bin is used or not, while variable <span class="math inline">\(x\)</span> indicates whether an item is placed in a particular bin.</p>
<p>The <code>create_objective()</code> method creates an objective function for the model using the Minimize method. It aims to minimize the number of used bins.</p>
<p>The <code>create_constraints()</code> method creates constraints for the model using the Add method. It creates two constraints for each bin. The first constraint ensures that the sum of the sizes of the items placed in a bin does not exceed the bin capacity. The second constraint ensures that each item is placed in exactly one bin.</p>
<div id="cell-9" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="im">from</span> ortools.linear_solver <span class="im">import</span> pywraplp</span>
<span id="cb2-4"><a href="#cb2-4"></a></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="kw">class</span> BppSolver:</span>
<span id="cb2-6"><a href="#cb2-6"></a>    </span>
<span id="cb2-7"><a href="#cb2-7"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, data_center):</span>
<span id="cb2-8"><a href="#cb2-8"></a>        <span class="va">self</span>._data_center <span class="op">=</span> data_center</span>
<span id="cb2-9"><a href="#cb2-9"></a>        </span>
<span id="cb2-10"><a href="#cb2-10"></a>        <span class="va">self</span>._solver <span class="op">=</span> <span class="va">None</span></span>
<span id="cb2-11"><a href="#cb2-11"></a>        <span class="va">self</span>._var_y <span class="op">=</span> <span class="va">None</span></span>
<span id="cb2-12"><a href="#cb2-12"></a>        <span class="va">self</span>._var_x <span class="op">=</span> <span class="va">None</span></span>
<span id="cb2-13"><a href="#cb2-13"></a>        </span>
<span id="cb2-14"><a href="#cb2-14"></a>        <span class="va">self</span>._opt_obj <span class="op">=</span> <span class="va">None</span></span>
<span id="cb2-15"><a href="#cb2-15"></a>        <span class="va">self</span>._opt_y <span class="op">=</span> <span class="va">None</span></span>
<span id="cb2-16"><a href="#cb2-16"></a>        <span class="va">self</span>._opt_x <span class="op">=</span> <span class="va">None</span></span>
<span id="cb2-17"><a href="#cb2-17"></a>        </span>
<span id="cb2-18"><a href="#cb2-18"></a>    <span class="kw">def</span> build_model(<span class="va">self</span>):</span>
<span id="cb2-19"><a href="#cb2-19"></a>        <span class="va">self</span>._solver <span class="op">=</span> pywraplp.Solver.CreateSolver(<span class="st">'SCIP'</span>)</span>
<span id="cb2-20"><a href="#cb2-20"></a>        <span class="va">self</span>._create_variables()</span>
<span id="cb2-21"><a href="#cb2-21"></a>        <span class="va">self</span>._create_objective()</span>
<span id="cb2-22"><a href="#cb2-22"></a>        <span class="va">self</span>._create_constraints()</span>
<span id="cb2-23"><a href="#cb2-23"></a>        </span>
<span id="cb2-24"><a href="#cb2-24"></a>    <span class="kw">def</span> optimize(<span class="va">self</span>):</span>
<span id="cb2-25"><a href="#cb2-25"></a>        num_bins <span class="op">=</span> <span class="va">self</span>._data_center.num_bins</span>
<span id="cb2-26"><a href="#cb2-26"></a>        num_items <span class="op">=</span> <span class="va">self</span>._data_center.num_items</span>
<span id="cb2-27"><a href="#cb2-27"></a>        </span>
<span id="cb2-28"><a href="#cb2-28"></a>        status <span class="op">=</span> <span class="va">self</span>._solver.Solve()</span>
<span id="cb2-29"><a href="#cb2-29"></a>        <span class="cf">if</span> status <span class="op">==</span> pywraplp.Solver.OPTIMAL:</span>
<span id="cb2-30"><a href="#cb2-30"></a>            <span class="va">self</span>._opt_obj <span class="op">=</span> <span class="va">self</span>._solver.Objective().Value()</span>
<span id="cb2-31"><a href="#cb2-31"></a>            <span class="va">self</span>._opt_y <span class="op">=</span> [</span>
<span id="cb2-32"><a href="#cb2-32"></a>                <span class="va">self</span>._var_y[b].solution_value()</span>
<span id="cb2-33"><a href="#cb2-33"></a>                <span class="cf">for</span> b <span class="kw">in</span> <span class="bu">range</span>(num_bins)</span>
<span id="cb2-34"><a href="#cb2-34"></a>            ]</span>
<span id="cb2-35"><a href="#cb2-35"></a>            <span class="va">self</span>._opt_x <span class="op">=</span> np.zeros((num_items, num_bins))</span>
<span id="cb2-36"><a href="#cb2-36"></a>            <span class="cf">for</span> i, b <span class="kw">in</span> product(<span class="bu">range</span>(num_items),</span>
<span id="cb2-37"><a href="#cb2-37"></a>                                <span class="bu">range</span>(num_bins)):</span>
<span id="cb2-38"><a href="#cb2-38"></a>                <span class="va">self</span>._opt_x[i][b] <span class="op">=</span> <span class="op">\</span></span>
<span id="cb2-39"><a href="#cb2-39"></a>                    <span class="va">self</span>._var_x[i][b].solution_value()</span>
<span id="cb2-40"><a href="#cb2-40"></a>        </span>
<span id="cb2-41"><a href="#cb2-41"></a>    <span class="kw">def</span> _create_variables(<span class="va">self</span>):</span>
<span id="cb2-42"><a href="#cb2-42"></a>        num_bins <span class="op">=</span> <span class="va">self</span>._data_center.num_bins</span>
<span id="cb2-43"><a href="#cb2-43"></a>        <span class="va">self</span>._var_y <span class="op">=</span> [</span>
<span id="cb2-44"><a href="#cb2-44"></a>            <span class="va">self</span>._solver.BoolVar(name<span class="op">=</span><span class="ss">f'y_</span><span class="sc">{</span>b<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb2-45"><a href="#cb2-45"></a>            <span class="cf">for</span> b <span class="kw">in</span> <span class="bu">range</span>(num_bins)</span>
<span id="cb2-46"><a href="#cb2-46"></a>        ]</span>
<span id="cb2-47"><a href="#cb2-47"></a>        num_items <span class="op">=</span> <span class="va">self</span>._data_center.num_items</span>
<span id="cb2-48"><a href="#cb2-48"></a>        <span class="va">self</span>._var_x <span class="op">=</span> np.empty((num_items, num_bins),</span>
<span id="cb2-49"><a href="#cb2-49"></a>                            dtype<span class="op">=</span><span class="bu">object</span>)</span>
<span id="cb2-50"><a href="#cb2-50"></a>        <span class="cf">for</span> i, b <span class="kw">in</span> product(<span class="bu">range</span>(num_items),</span>
<span id="cb2-51"><a href="#cb2-51"></a>                            <span class="bu">range</span>(num_bins)):</span>
<span id="cb2-52"><a href="#cb2-52"></a>            <span class="va">self</span>._var_x[i][b] <span class="op">=</span> <span class="op">\</span></span>
<span id="cb2-53"><a href="#cb2-53"></a>                <span class="va">self</span>._solver.BoolVar(name<span class="op">=</span><span class="ss">f'x_</span><span class="sc">{</span>i<span class="sc">,</span> b<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb2-54"><a href="#cb2-54"></a>        </span>
<span id="cb2-55"><a href="#cb2-55"></a>    <span class="kw">def</span> _create_objective(<span class="va">self</span>):</span>
<span id="cb2-56"><a href="#cb2-56"></a>        <span class="va">self</span>._solver.Minimize(</span>
<span id="cb2-57"><a href="#cb2-57"></a>            <span class="va">self</span>._solver.Sum(</span>
<span id="cb2-58"><a href="#cb2-58"></a>                <span class="va">self</span>._var_y</span>
<span id="cb2-59"><a href="#cb2-59"></a>            )</span>
<span id="cb2-60"><a href="#cb2-60"></a>        )</span>
<span id="cb2-61"><a href="#cb2-61"></a>        </span>
<span id="cb2-62"><a href="#cb2-62"></a>    <span class="kw">def</span> _create_constraints(<span class="va">self</span>):</span>
<span id="cb2-63"><a href="#cb2-63"></a>        num_bins <span class="op">=</span> <span class="va">self</span>._data_center.num_bins</span>
<span id="cb2-64"><a href="#cb2-64"></a>        num_items <span class="op">=</span> <span class="va">self</span>._data_center.num_items</span>
<span id="cb2-65"><a href="#cb2-65"></a>        bin_capacity <span class="op">=</span> <span class="va">self</span>._data_center.bin_capacity</span>
<span id="cb2-66"><a href="#cb2-66"></a>        item_sizes <span class="op">=</span> <span class="va">self</span>._data_center.item_sizes</span>
<span id="cb2-67"><a href="#cb2-67"></a>        <span class="cf">for</span> b <span class="kw">in</span> <span class="bu">range</span>(num_bins):</span>
<span id="cb2-68"><a href="#cb2-68"></a>            expr <span class="op">=</span> [</span>
<span id="cb2-69"><a href="#cb2-69"></a>                item_sizes[i] <span class="op">*</span></span>
<span id="cb2-70"><a href="#cb2-70"></a>                <span class="va">self</span>._var_x[i][b]</span>
<span id="cb2-71"><a href="#cb2-71"></a>                <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_items)</span>
<span id="cb2-72"><a href="#cb2-72"></a>            ]</span>
<span id="cb2-73"><a href="#cb2-73"></a>            <span class="va">self</span>._solver.Add(</span>
<span id="cb2-74"><a href="#cb2-74"></a>                <span class="va">self</span>._solver.Sum(expr) <span class="op">&lt;=</span> <span class="op">\</span></span>
<span id="cb2-75"><a href="#cb2-75"></a>                    bin_capacity <span class="op">*</span> <span class="va">self</span>._var_y[b]</span>
<span id="cb2-76"><a href="#cb2-76"></a>            )</span>
<span id="cb2-77"><a href="#cb2-77"></a>            </span>
<span id="cb2-78"><a href="#cb2-78"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_items):</span>
<span id="cb2-79"><a href="#cb2-79"></a>            expr <span class="op">=</span> [</span>
<span id="cb2-80"><a href="#cb2-80"></a>                <span class="va">self</span>._var_x[i][b]</span>
<span id="cb2-81"><a href="#cb2-81"></a>                <span class="cf">for</span> b <span class="kw">in</span> <span class="bu">range</span>(num_bins)</span>
<span id="cb2-82"><a href="#cb2-82"></a>            ]</span>
<span id="cb2-83"><a href="#cb2-83"></a>            <span class="va">self</span>._solver.Add(</span>
<span id="cb2-84"><a href="#cb2-84"></a>                <span class="va">self</span>._solver.Sum(expr) <span class="op">==</span> <span class="dv">1</span></span>
<span id="cb2-85"><a href="#cb2-85"></a>            )</span>
<span id="cb2-86"><a href="#cb2-86"></a>        </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the code below, we try to solve a BPP instance using the above class. The file <em>binpack1.txt</em> contains several instances and they are all too large to solve within reasonable time. We will solve a truncated version of the first instance in the file by considering only the first 15 items. The optimal objective value is 6.</p>
<div id="cell-11" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="im">import</span> re</span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a>data_file <span class="op">=</span> <span class="st">"./data/bpp/binpack1.txt"</span></span>
<span id="cb3-4"><a href="#cb3-4"></a></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="cf">with</span> <span class="bu">open</span>(data_file) <span class="im">as</span> f:</span>
<span id="cb3-6"><a href="#cb3-6"></a>    num_instanes <span class="op">=</span> <span class="bu">int</span>(f.readline())</span>
<span id="cb3-7"><a href="#cb3-7"></a>    </span>
<span id="cb3-8"><a href="#cb3-8"></a>    <span class="cf">for</span> inst <span class="kw">in</span> <span class="bu">range</span>(num_instanes):</span>
<span id="cb3-9"><a href="#cb3-9"></a>        inst_name <span class="op">=</span> f.readline()[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb3-10"><a href="#cb3-10"></a>        <span class="bu">print</span>(<span class="ss">f"Solving instance: </span><span class="sc">{</span>inst_name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-11"><a href="#cb3-11"></a>        bin_capacity, <span class="op">\</span></span>
<span id="cb3-12"><a href="#cb3-12"></a>        num_items, <span class="op">\</span></span>
<span id="cb3-13"><a href="#cb3-13"></a>        min_num_bins <span class="op">=</span> f.readline().split()</span>
<span id="cb3-14"><a href="#cb3-14"></a>        sizes <span class="op">=</span> []</span>
<span id="cb3-15"><a href="#cb3-15"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">int</span>(num_items)):</span>
<span id="cb3-16"><a href="#cb3-16"></a>            line <span class="op">=</span> f.readline()</span>
<span id="cb3-17"><a href="#cb3-17"></a>            number <span class="op">=</span> <span class="bu">int</span>(re.findall(<span class="vs">r'\d+'</span>, line)[<span class="dv">0</span>])</span>
<span id="cb3-18"><a href="#cb3-18"></a>            sizes.append(number)</span>
<span id="cb3-19"><a href="#cb3-19"></a>        </span>
<span id="cb3-20"><a href="#cb3-20"></a>        data_center <span class="op">=</span> BppDataCenter(</span>
<span id="cb3-21"><a href="#cb3-21"></a>                    num_bins<span class="op">=</span><span class="bu">int</span>(min_num_bins),</span>
<span id="cb3-22"><a href="#cb3-22"></a>                    num_items<span class="op">=</span><span class="dv">15</span>,</span>
<span id="cb3-23"><a href="#cb3-23"></a>                    bin_capacity<span class="op">=</span><span class="bu">int</span>(bin_capacity),</span>
<span id="cb3-24"><a href="#cb3-24"></a>                    item_sizes<span class="op">=</span>sizes</span>
<span id="cb3-25"><a href="#cb3-25"></a>                )</span>
<span id="cb3-26"><a href="#cb3-26"></a></span>
<span id="cb3-27"><a href="#cb3-27"></a>        solver <span class="op">=</span> BppSolver(data_center)                       </span>
<span id="cb3-28"><a href="#cb3-28"></a>        solver.build_model()</span>
<span id="cb3-29"><a href="#cb3-29"></a>        solver.optimize()</span>
<span id="cb3-30"><a href="#cb3-30"></a>        <span class="bu">print</span>(<span class="ss">f'Optimal objective value = </span><span class="sc">{</span>solver<span class="sc">.</span>_opt_obj<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb3-31"><a href="#cb3-31"></a>        <span class="cf">break</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Solving instance:  u120_00 
Optimal objective value = 6.0</code></pre>
</div>
</div>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    const typesetMath = (el) => {
      if (window.MathJax) {
        // MathJax Typeset
        window.MathJax.typeset([el]);
      } else if (window.katex) {
        // KaTeX Render
        var mathElements = el.getElementsByClassName("math");
        var macros = [];
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") {
            window.katex.render(texText.data, mathElements[i], {
              displayMode: mathElements[i].classList.contains('display'),
              throwOnError: false,
              macros: macros,
              fleqn: false
            });
          }
        }
      }
    }
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        typesetMath(container);
        return container.innerHTML
      } else {
        typesetMath(note);
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      typesetMath(note);
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ip-cutting-stock.html" class="pagination-link  aria-label=" &lt;span="" cutting="" stock="" problem&lt;="" span&gt;"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">The Cutting Stock Problem</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ip-branch-bound.html" class="pagination-link" aria-label="<span class='chapter-number'>14</span>&nbsp; <span class='chapter-title'>Hands-On Branch and Bound</span>">
        <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Hands-On Branch and Bound</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>